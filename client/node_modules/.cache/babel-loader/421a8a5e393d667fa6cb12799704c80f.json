{"ast":null,"code":"!function (t, n) {\n  \"object\" == typeof exports && \"undefined\" != typeof module ? module.exports = n() : \"function\" == typeof define && define.amd ? define(n) : (t = t || self).barba = n();\n}(this, function () {\n  function t(t, n) {\n    for (var r = 0; r < n.length; r++) {\n      var e = n[r];\n      e.enumerable = e.enumerable || !1, e.configurable = !0, \"value\" in e && (e.writable = !0), Object.defineProperty(t, e.key, e);\n    }\n  }\n\n  function n(n, r, e) {\n    return r && t(n.prototype, r), e && t(n, e), n;\n  }\n\n  function r() {\n    return (r = Object.assign || function (t) {\n      for (var n = 1; n < arguments.length; n++) {\n        var r = arguments[n];\n\n        for (var e in r) Object.prototype.hasOwnProperty.call(r, e) && (t[e] = r[e]);\n      }\n\n      return t;\n    }).apply(this, arguments);\n  }\n\n  function e(t, n) {\n    t.prototype = Object.create(n.prototype), t.prototype.constructor = t, t.__proto__ = n;\n  }\n\n  function i(t) {\n    return (i = Object.setPrototypeOf ? Object.getPrototypeOf : function (t) {\n      return t.__proto__ || Object.getPrototypeOf(t);\n    })(t);\n  }\n\n  function o(t, n) {\n    return (o = Object.setPrototypeOf || function (t, n) {\n      return t.__proto__ = n, t;\n    })(t, n);\n  }\n\n  function u(t, n, r) {\n    return (u = function () {\n      if (\"undefined\" == typeof Reflect || !Reflect.construct) return !1;\n      if (Reflect.construct.sham) return !1;\n      if (\"function\" == typeof Proxy) return !0;\n\n      try {\n        return Date.prototype.toString.call(Reflect.construct(Date, [], function () {})), !0;\n      } catch (t) {\n        return !1;\n      }\n    }() ? Reflect.construct : function (t, n, r) {\n      var e = [null];\n      e.push.apply(e, n);\n      var i = new (Function.bind.apply(t, e))();\n      return r && o(i, r.prototype), i;\n    }).apply(null, arguments);\n  }\n\n  function f(t) {\n    var n = \"function\" == typeof Map ? new Map() : void 0;\n    return (f = function (t) {\n      if (null === t || -1 === Function.toString.call(t).indexOf(\"[native code]\")) return t;\n      if (\"function\" != typeof t) throw new TypeError(\"Super expression must either be null or a function\");\n\n      if (void 0 !== n) {\n        if (n.has(t)) return n.get(t);\n        n.set(t, r);\n      }\n\n      function r() {\n        return u(t, arguments, i(this).constructor);\n      }\n\n      return r.prototype = Object.create(t.prototype, {\n        constructor: {\n          value: r,\n          enumerable: !1,\n          writable: !0,\n          configurable: !0\n        }\n      }), o(r, t);\n    })(t);\n  }\n\n  function s(t, n) {\n    try {\n      var r = t();\n    } catch (t) {\n      return n(t);\n    }\n\n    return r && r.then ? r.then(void 0, n) : r;\n  }\n\n  \"undefined\" != typeof Symbol && (Symbol.iterator || (Symbol.iterator = Symbol(\"Symbol.iterator\"))), \"undefined\" != typeof Symbol && (Symbol.asyncIterator || (Symbol.asyncIterator = Symbol(\"Symbol.asyncIterator\")));\n\n  var c,\n      a = \"2.9.7\",\n      h = function () {};\n\n  !function (t) {\n    t[t.off = 0] = \"off\", t[t.error = 1] = \"error\", t[t.warning = 2] = \"warning\", t[t.info = 3] = \"info\", t[t.debug = 4] = \"debug\";\n  }(c || (c = {}));\n\n  var v = c.off,\n      l = function () {\n    function t(t) {\n      this.t = t;\n    }\n\n    t.getLevel = function () {\n      return v;\n    }, t.setLevel = function (t) {\n      return v = c[t];\n    };\n    var n = t.prototype;\n    return n.error = function () {\n      for (var t = arguments.length, n = new Array(t), r = 0; r < t; r++) n[r] = arguments[r];\n\n      this.i(console.error, c.error, n);\n    }, n.warn = function () {\n      for (var t = arguments.length, n = new Array(t), r = 0; r < t; r++) n[r] = arguments[r];\n\n      this.i(console.warn, c.warning, n);\n    }, n.info = function () {\n      for (var t = arguments.length, n = new Array(t), r = 0; r < t; r++) n[r] = arguments[r];\n\n      this.i(console.info, c.info, n);\n    }, n.debug = function () {\n      for (var t = arguments.length, n = new Array(t), r = 0; r < t; r++) n[r] = arguments[r];\n\n      this.i(console.log, c.debug, n);\n    }, n.i = function (n, r, e) {\n      r <= t.getLevel() && n.apply(console, [\"[\" + this.t + \"] \"].concat(e));\n    }, t;\n  }(),\n      d = O,\n      m = E,\n      p = g,\n      w = x,\n      b = T,\n      y = \"/\",\n      P = new RegExp([\"(\\\\\\\\.)\", \"(?:\\\\:(\\\\w+)(?:\\\\(((?:\\\\\\\\.|[^\\\\\\\\()])+)\\\\))?|\\\\(((?:\\\\\\\\.|[^\\\\\\\\()])+)\\\\))([+*?])?\"].join(\"|\"), \"g\");\n\n  function g(t, n) {\n    for (var r, e = [], i = 0, o = 0, u = \"\", f = n && n.delimiter || y, s = n && n.whitelist || void 0, c = !1; null !== (r = P.exec(t));) {\n      var a = r[0],\n          h = r[1],\n          v = r.index;\n      if (u += t.slice(o, v), o = v + a.length, h) u += h[1], c = !0;else {\n        var l = \"\",\n            d = r[2],\n            m = r[3],\n            p = r[4],\n            w = r[5];\n\n        if (!c && u.length) {\n          var b = u.length - 1,\n              g = u[b];\n          (!s || s.indexOf(g) > -1) && (l = g, u = u.slice(0, b));\n        }\n\n        u && (e.push(u), u = \"\", c = !1);\n        var E = m || p,\n            x = l || f;\n        e.push({\n          name: d || i++,\n          prefix: l,\n          delimiter: x,\n          optional: \"?\" === w || \"*\" === w,\n          repeat: \"+\" === w || \"*\" === w,\n          pattern: E ? A(E) : \"[^\" + k(x === f ? x : x + f) + \"]+?\"\n        });\n      }\n    }\n\n    return (u || o < t.length) && e.push(u + t.substr(o)), e;\n  }\n\n  function E(t, n) {\n    return function (r, e) {\n      var i = t.exec(r);\n      if (!i) return !1;\n\n      for (var o = i[0], u = i.index, f = {}, s = e && e.decode || decodeURIComponent, c = 1; c < i.length; c++) if (void 0 !== i[c]) {\n        var a = n[c - 1];\n        f[a.name] = a.repeat ? i[c].split(a.delimiter).map(function (t) {\n          return s(t, a);\n        }) : s(i[c], a);\n      }\n\n      return {\n        path: o,\n        index: u,\n        params: f\n      };\n    };\n  }\n\n  function x(t, n) {\n    for (var r = new Array(t.length), e = 0; e < t.length; e++) \"object\" == typeof t[e] && (r[e] = new RegExp(\"^(?:\" + t[e].pattern + \")$\", R(n)));\n\n    return function (n, e) {\n      for (var i = \"\", o = e && e.encode || encodeURIComponent, u = !e || !1 !== e.validate, f = 0; f < t.length; f++) {\n        var s = t[f];\n\n        if (\"string\" != typeof s) {\n          var c,\n              a = n ? n[s.name] : void 0;\n\n          if (Array.isArray(a)) {\n            if (!s.repeat) throw new TypeError('Expected \"' + s.name + '\" to not repeat, but got array');\n\n            if (0 === a.length) {\n              if (s.optional) continue;\n              throw new TypeError('Expected \"' + s.name + '\" to not be empty');\n            }\n\n            for (var h = 0; h < a.length; h++) {\n              if (c = o(a[h], s), u && !r[f].test(c)) throw new TypeError('Expected all \"' + s.name + '\" to match \"' + s.pattern + '\"');\n              i += (0 === h ? s.prefix : s.delimiter) + c;\n            }\n          } else if (\"string\" != typeof a && \"number\" != typeof a && \"boolean\" != typeof a) {\n            if (!s.optional) throw new TypeError('Expected \"' + s.name + '\" to be ' + (s.repeat ? \"an array\" : \"a string\"));\n          } else {\n            if (c = o(String(a), s), u && !r[f].test(c)) throw new TypeError('Expected \"' + s.name + '\" to match \"' + s.pattern + '\", but got \"' + c + '\"');\n            i += s.prefix + c;\n          }\n        } else i += s;\n      }\n\n      return i;\n    };\n  }\n\n  function k(t) {\n    return t.replace(/([.+*?=^!:${}()[\\]|/\\\\])/g, \"\\\\$1\");\n  }\n\n  function A(t) {\n    return t.replace(/([=!:$/()])/g, \"\\\\$1\");\n  }\n\n  function R(t) {\n    return t && t.sensitive ? \"\" : \"i\";\n  }\n\n  function T(t, n, r) {\n    for (var e = (r = r || {}).strict, i = !1 !== r.start, o = !1 !== r.end, u = r.delimiter || y, f = [].concat(r.endsWith || []).map(k).concat(\"$\").join(\"|\"), s = i ? \"^\" : \"\", c = 0; c < t.length; c++) {\n      var a = t[c];\n      if (\"string\" == typeof a) s += k(a);else {\n        var h = a.repeat ? \"(?:\" + a.pattern + \")(?:\" + k(a.delimiter) + \"(?:\" + a.pattern + \"))*\" : a.pattern;\n        n && n.push(a), s += a.optional ? a.prefix ? \"(?:\" + k(a.prefix) + \"(\" + h + \"))?\" : \"(\" + h + \")?\" : k(a.prefix) + \"(\" + h + \")\";\n      }\n    }\n\n    if (o) e || (s += \"(?:\" + k(u) + \")?\"), s += \"$\" === f ? \"$\" : \"(?=\" + f + \")\";else {\n      var v = t[t.length - 1],\n          l = \"string\" == typeof v ? v[v.length - 1] === u : void 0 === v;\n      e || (s += \"(?:\" + k(u) + \"(?=\" + f + \"))?\"), l || (s += \"(?=\" + k(u) + \"|\" + f + \")\");\n    }\n    return new RegExp(s, R(r));\n  }\n\n  function O(t, n, r) {\n    return t instanceof RegExp ? function (t, n) {\n      if (!n) return t;\n      var r = t.source.match(/\\((?!\\?)/g);\n      if (r) for (var e = 0; e < r.length; e++) n.push({\n        name: e,\n        prefix: null,\n        delimiter: null,\n        optional: !1,\n        repeat: !1,\n        pattern: null\n      });\n      return t;\n    }(t, n) : Array.isArray(t) ? function (t, n, r) {\n      for (var e = [], i = 0; i < t.length; i++) e.push(O(t[i], n, r).source);\n\n      return new RegExp(\"(?:\" + e.join(\"|\") + \")\", R(r));\n    }(t, n, r) : function (t, n, r) {\n      return T(g(t, r), n, r);\n    }(t, n, r);\n  }\n\n  d.match = function (t, n) {\n    var r = [];\n    return E(O(t, r, n), r);\n  }, d.regexpToFunction = m, d.parse = p, d.compile = function (t, n) {\n    return x(g(t, n), n);\n  }, d.tokensToFunction = w, d.tokensToRegExp = b;\n\n  var S = {\n    container: \"container\",\n    history: \"history\",\n    namespace: \"namespace\",\n    prefix: \"data-barba\",\n    prevent: \"prevent\",\n    wrapper: \"wrapper\"\n  },\n      j = new (function () {\n    function t() {\n      this.o = S, this.u = new DOMParser();\n    }\n\n    var n = t.prototype;\n    return n.toString = function (t) {\n      return t.outerHTML;\n    }, n.toDocument = function (t) {\n      return this.u.parseFromString(t, \"text/html\");\n    }, n.toElement = function (t) {\n      var n = document.createElement(\"div\");\n      return n.innerHTML = t, n;\n    }, n.getHtml = function (t) {\n      return void 0 === t && (t = document), this.toString(t.documentElement);\n    }, n.getWrapper = function (t) {\n      return void 0 === t && (t = document), t.querySelector(\"[\" + this.o.prefix + '=\"' + this.o.wrapper + '\"]');\n    }, n.getContainer = function (t) {\n      return void 0 === t && (t = document), t.querySelector(\"[\" + this.o.prefix + '=\"' + this.o.container + '\"]');\n    }, n.removeContainer = function (t) {\n      document.body.contains(t) && t.parentNode.removeChild(t);\n    }, n.addContainer = function (t, n) {\n      var r = this.getContainer();\n      r ? this.s(t, r) : n.appendChild(t);\n    }, n.getNamespace = function (t) {\n      void 0 === t && (t = document);\n      var n = t.querySelector(\"[\" + this.o.prefix + \"-\" + this.o.namespace + \"]\");\n      return n ? n.getAttribute(this.o.prefix + \"-\" + this.o.namespace) : null;\n    }, n.getHref = function (t) {\n      if (t.tagName && \"a\" === t.tagName.toLowerCase()) {\n        if (\"string\" == typeof t.href) return t.href;\n        var n = t.getAttribute(\"href\") || t.getAttribute(\"xlink:href\");\n        if (n) return this.resolveUrl(n.baseVal || n);\n      }\n\n      return null;\n    }, n.resolveUrl = function () {\n      for (var t = arguments.length, n = new Array(t), r = 0; r < t; r++) n[r] = arguments[r];\n\n      var e = n.length;\n      if (0 === e) throw new Error(\"resolveUrl requires at least one argument; got none.\");\n      var i = document.createElement(\"base\");\n      if (i.href = arguments[0], 1 === e) return i.href;\n      var o = document.getElementsByTagName(\"head\")[0];\n      o.insertBefore(i, o.firstChild);\n\n      for (var u, f = document.createElement(\"a\"), s = 1; s < e; s++) f.href = arguments[s], i.href = u = f.href;\n\n      return o.removeChild(i), u;\n    }, n.s = function (t, n) {\n      n.parentNode.insertBefore(t, n.nextSibling);\n    }, t;\n  }())(),\n      M = new (function () {\n    function t() {\n      this.h = [], this.v = -1;\n    }\n\n    var e = t.prototype;\n    return e.init = function (t, n) {\n      this.l = \"barba\";\n      var r = {\n        ns: n,\n        scroll: {\n          x: window.scrollX,\n          y: window.scrollY\n        },\n        url: t\n      };\n      this.h.push(r), this.v = 0;\n      var e = {\n        from: this.l,\n        index: 0,\n        states: [].concat(this.h)\n      };\n      window.history && window.history.replaceState(e, \"\", t);\n    }, e.change = function (t, n, r) {\n      if (r && r.state) {\n        var e = r.state,\n            i = e.index;\n        n = this.m(this.v - i), this.replace(e.states), this.v = i;\n      } else this.add(t, n);\n\n      return n;\n    }, e.add = function (t, n) {\n      var r = this.size,\n          e = this.p(n),\n          i = {\n        ns: \"tmp\",\n        scroll: {\n          x: window.scrollX,\n          y: window.scrollY\n        },\n        url: t\n      };\n      this.h.push(i), this.v = r;\n      var o = {\n        from: this.l,\n        index: r,\n        states: [].concat(this.h)\n      };\n\n      switch (e) {\n        case \"push\":\n          window.history && window.history.pushState(o, \"\", t);\n          break;\n\n        case \"replace\":\n          window.history && window.history.replaceState(o, \"\", t);\n      }\n    }, e.update = function (t, n) {\n      var e = n || this.v,\n          i = r({}, this.get(e), {}, t);\n      this.set(e, i);\n    }, e.remove = function (t) {\n      t ? this.h.splice(t, 1) : this.h.pop(), this.v--;\n    }, e.clear = function () {\n      this.h = [], this.v = -1;\n    }, e.replace = function (t) {\n      this.h = t;\n    }, e.get = function (t) {\n      return this.h[t];\n    }, e.set = function (t, n) {\n      return this.h[t] = n;\n    }, e.p = function (t) {\n      var n = \"push\",\n          r = t,\n          e = S.prefix + \"-\" + S.history;\n      return r.hasAttribute && r.hasAttribute(e) && (n = r.getAttribute(e)), n;\n    }, e.m = function (t) {\n      return Math.abs(t) > 1 ? t > 0 ? \"forward\" : \"back\" : 0 === t ? \"popstate\" : t > 0 ? \"back\" : \"forward\";\n    }, n(t, [{\n      key: \"current\",\n      get: function () {\n        return this.h[this.v];\n      }\n    }, {\n      key: \"state\",\n      get: function () {\n        return this.h[this.h.length - 1];\n      }\n    }, {\n      key: \"previous\",\n      get: function () {\n        return this.v < 1 ? null : this.h[this.v - 1];\n      }\n    }, {\n      key: \"size\",\n      get: function () {\n        return this.h.length;\n      }\n    }]), t;\n  }())(),\n      L = function (t, n) {\n    try {\n      var r = function () {\n        if (!n.next.html) return Promise.resolve(t).then(function (t) {\n          var r = n.next;\n\n          if (t) {\n            var e = j.toElement(t);\n            r.namespace = j.getNamespace(e), r.container = j.getContainer(e), r.html = t, M.update({\n              ns: r.namespace\n            });\n            var i = j.toDocument(t);\n            document.title = i.title;\n          }\n        });\n      }();\n\n      return Promise.resolve(r && r.then ? r.then(function () {}) : void 0);\n    } catch (t) {\n      return Promise.reject(t);\n    }\n  },\n      $ = d,\n      _ = {\n    __proto__: null,\n    update: L,\n    nextTick: function () {\n      return new Promise(function (t) {\n        window.requestAnimationFrame(t);\n      });\n    },\n    pathToRegexp: $\n  },\n      q = function () {\n    return window.location.origin;\n  },\n      B = function (t) {\n    return void 0 === t && (t = window.location.href), U(t).port;\n  },\n      U = function (t) {\n    var n,\n        r = t.match(/:\\d+/);\n    if (null === r) /^http/.test(t) && (n = 80), /^https/.test(t) && (n = 443);else {\n      var e = r[0].substring(1);\n      n = parseInt(e, 10);\n    }\n    var i,\n        o = t.replace(q(), \"\"),\n        u = {},\n        f = o.indexOf(\"#\");\n    f >= 0 && (i = o.slice(f + 1), o = o.slice(0, f));\n    var s = o.indexOf(\"?\");\n    return s >= 0 && (u = D(o.slice(s + 1)), o = o.slice(0, s)), {\n      hash: i,\n      path: o,\n      port: n,\n      query: u\n    };\n  },\n      D = function (t) {\n    return t.split(\"&\").reduce(function (t, n) {\n      var r = n.split(\"=\");\n      return t[r[0]] = r[1], t;\n    }, {});\n  },\n      F = function (t) {\n    return void 0 === t && (t = window.location.href), t.replace(/(\\/#.*|\\/|#.*)$/, \"\");\n  },\n      H = {\n    __proto__: null,\n    getHref: function () {\n      return window.location.href;\n    },\n    getOrigin: q,\n    getPort: B,\n    getPath: function (t) {\n      return void 0 === t && (t = window.location.href), U(t).path;\n    },\n    parse: U,\n    parseQuery: D,\n    clean: F\n  };\n\n  function I(t, n, r) {\n    return void 0 === n && (n = 2e3), new Promise(function (e, i) {\n      var o = new XMLHttpRequest();\n      o.onreadystatechange = function () {\n        if (o.readyState === XMLHttpRequest.DONE) if (200 === o.status) e(o.responseText);else if (o.status) {\n          var n = {\n            status: o.status,\n            statusText: o.statusText\n          };\n          r(t, n), i(n);\n        }\n      }, o.ontimeout = function () {\n        var e = new Error(\"Timeout error [\" + n + \"]\");\n        r(t, e), i(e);\n      }, o.onerror = function () {\n        var n = new Error(\"Fetch error\");\n        r(t, n), i(n);\n      }, o.open(\"GET\", t), o.timeout = n, o.setRequestHeader(\"Accept\", \"text/html,application/xhtml+xml,application/xml\"), o.setRequestHeader(\"x-barba\", \"yes\"), o.send();\n    });\n  }\n\n  var C = function (t) {\n    return !!t && (\"object\" == typeof t || \"function\" == typeof t) && \"function\" == typeof t.then;\n  };\n\n  function N(t, n) {\n    return void 0 === n && (n = {}), function () {\n      for (var r = arguments.length, e = new Array(r), i = 0; i < r; i++) e[i] = arguments[i];\n\n      var o = !1,\n          u = new Promise(function (r, i) {\n        n.async = function () {\n          return o = !0, function (t, n) {\n            t ? i(t) : r(n);\n          };\n        };\n\n        var u = t.apply(n, e);\n        o || (C(u) ? u.then(r, i) : r(u));\n      });\n      return u;\n    };\n  }\n\n  var X = new (function (t) {\n    function n() {\n      var n;\n      return (n = t.call(this) || this).logger = new l(\"@barba/core\"), n.all = [\"ready\", \"page\", \"reset\", \"currentAdded\", \"currentRemoved\", \"nextAdded\", \"nextRemoved\", \"beforeOnce\", \"once\", \"afterOnce\", \"before\", \"beforeLeave\", \"leave\", \"afterLeave\", \"beforeEnter\", \"enter\", \"afterEnter\", \"after\"], n.registered = new Map(), n.init(), n;\n    }\n\n    e(n, t);\n    var r = n.prototype;\n    return r.init = function () {\n      var t = this;\n      this.registered.clear(), this.all.forEach(function (n) {\n        t[n] || (t[n] = function (r, e) {\n          t.registered.has(n) || t.registered.set(n, new Set()), t.registered.get(n).add({\n            ctx: e || {},\n            fn: r\n          });\n        });\n      });\n    }, r.do = function (t) {\n      for (var n = this, r = arguments.length, e = new Array(r > 1 ? r - 1 : 0), i = 1; i < r; i++) e[i - 1] = arguments[i];\n\n      if (this.registered.has(t)) {\n        var o = Promise.resolve();\n        return this.registered.get(t).forEach(function (t) {\n          o = o.then(function () {\n            return N(t.fn, t.ctx).apply(void 0, e);\n          });\n        }), o.catch(function (r) {\n          n.logger.debug(\"Hook error [\" + t + \"]\"), n.logger.error(r);\n        });\n      }\n\n      return Promise.resolve();\n    }, r.clear = function () {\n      var t = this;\n      this.all.forEach(function (n) {\n        delete t[n];\n      }), this.init();\n    }, r.help = function () {\n      this.logger.info(\"Available hooks: \" + this.all.join(\",\"));\n      var t = [];\n      this.registered.forEach(function (n, r) {\n        return t.push(r);\n      }), this.logger.info(\"Registered hooks: \" + t.join(\",\"));\n    }, n;\n  }(h))(),\n      z = function () {\n    function t(t) {\n      if (this.P = [], \"boolean\" == typeof t) this.g = t;else {\n        var n = Array.isArray(t) ? t : [t];\n        this.P = n.map(function (t) {\n          return $(t);\n        });\n      }\n    }\n\n    return t.prototype.checkHref = function (t) {\n      if (\"boolean\" == typeof this.g) return this.g;\n      var n = U(t).path;\n      return this.P.some(function (t) {\n        return null !== t.exec(n);\n      });\n    }, t;\n  }(),\n      G = function (t) {\n    function n(n) {\n      var r;\n      return (r = t.call(this, n) || this).k = new Map(), r;\n    }\n\n    e(n, t);\n    var i = n.prototype;\n    return i.set = function (t, n, r) {\n      return this.k.set(t, {\n        action: r,\n        request: n\n      }), {\n        action: r,\n        request: n\n      };\n    }, i.get = function (t) {\n      return this.k.get(t);\n    }, i.getRequest = function (t) {\n      return this.k.get(t).request;\n    }, i.getAction = function (t) {\n      return this.k.get(t).action;\n    }, i.has = function (t) {\n      return !this.checkHref(t) && this.k.has(t);\n    }, i.delete = function (t) {\n      return this.k.delete(t);\n    }, i.update = function (t, n) {\n      var e = r({}, this.k.get(t), {}, n);\n      return this.k.set(t, e), e;\n    }, n;\n  }(z),\n      Q = function () {\n    return !window.history.pushState;\n  },\n      W = function (t) {\n    return !t.el || !t.href;\n  },\n      J = function (t) {\n    var n = t.event;\n    return n.which > 1 || n.metaKey || n.ctrlKey || n.shiftKey || n.altKey;\n  },\n      K = function (t) {\n    var n = t.el;\n    return n.hasAttribute(\"target\") && \"_blank\" === n.target;\n  },\n      V = function (t) {\n    var n = t.el;\n    return void 0 !== n.protocol && window.location.protocol !== n.protocol || void 0 !== n.hostname && window.location.hostname !== n.hostname;\n  },\n      Y = function (t) {\n    var n = t.el;\n    return void 0 !== n.port && B() !== B(n.href);\n  },\n      Z = function (t) {\n    var n = t.el;\n    return n.getAttribute && \"string\" == typeof n.getAttribute(\"download\");\n  },\n      tt = function (t) {\n    return t.el.hasAttribute(S.prefix + \"-\" + S.prevent);\n  },\n      nt = function (t) {\n    return Boolean(t.el.closest(\"[\" + S.prefix + \"-\" + S.prevent + '=\"all\"]'));\n  },\n      rt = function (t) {\n    var n = t.href;\n    return F(n) === F() && B(n) === B();\n  },\n      et = function (t) {\n    function n(n) {\n      var r;\n      return (r = t.call(this, n) || this).suite = [], r.tests = new Map(), r.init(), r;\n    }\n\n    e(n, t);\n    var r = n.prototype;\n    return r.init = function () {\n      this.add(\"pushState\", Q), this.add(\"exists\", W), this.add(\"newTab\", J), this.add(\"blank\", K), this.add(\"corsDomain\", V), this.add(\"corsPort\", Y), this.add(\"download\", Z), this.add(\"preventSelf\", tt), this.add(\"preventAll\", nt), this.add(\"sameUrl\", rt, !1);\n    }, r.add = function (t, n, r) {\n      void 0 === r && (r = !0), this.tests.set(t, n), r && this.suite.push(t);\n    }, r.run = function (t, n, r, e) {\n      return this.tests.get(t)({\n        el: n,\n        event: r,\n        href: e\n      });\n    }, r.checkLink = function (t, n, r) {\n      var e = this;\n      return this.suite.some(function (i) {\n        return e.run(i, t, n, r);\n      });\n    }, n;\n  }(z),\n      it = function (t) {\n    function n(r, e) {\n      var i;\n      void 0 === e && (e = \"Barba error\");\n\n      for (var o = arguments.length, u = new Array(o > 2 ? o - 2 : 0), f = 2; f < o; f++) u[f - 2] = arguments[f];\n\n      return (i = t.call.apply(t, [this].concat(u)) || this).error = r, i.label = e, Error.captureStackTrace && Error.captureStackTrace(function (t) {\n        if (void 0 === t) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n        return t;\n      }(i), n), i.name = \"BarbaError\", i;\n    }\n\n    return e(n, t), n;\n  }(f(Error)),\n      ot = function () {\n    function t(t) {\n      void 0 === t && (t = []), this.logger = new l(\"@barba/core\"), this.all = [], this.page = [], this.once = [], this.A = [{\n        name: \"namespace\",\n        type: \"strings\"\n      }, {\n        name: \"custom\",\n        type: \"function\"\n      }], t && (this.all = this.all.concat(t)), this.update();\n    }\n\n    var n = t.prototype;\n    return n.add = function (t, n) {\n      switch (t) {\n        case \"rule\":\n          this.A.splice(n.position || 0, 0, n.value);\n          break;\n\n        case \"transition\":\n        default:\n          this.all.push(n);\n      }\n\n      this.update();\n    }, n.resolve = function (t, n) {\n      var r = this;\n      void 0 === n && (n = {});\n      var e = n.once ? this.once : this.page;\n      e = e.filter(n.self ? function (t) {\n        return t.name && \"self\" === t.name;\n      } : function (t) {\n        return !t.name || \"self\" !== t.name;\n      });\n      var i = new Map(),\n          o = e.find(function (e) {\n        var o = !0,\n            u = {};\n        return !(!n.self || \"self\" !== e.name) || (r.A.reverse().forEach(function (n) {\n          o && (o = r.R(e, n, t, u), e.from && e.to && (o = r.R(e, n, t, u, \"from\") && r.R(e, n, t, u, \"to\")), e.from && !e.to && (o = r.R(e, n, t, u, \"from\")), !e.from && e.to && (o = r.R(e, n, t, u, \"to\")));\n        }), i.set(e, u), o);\n      }),\n          u = i.get(o),\n          f = [];\n\n      if (f.push(n.once ? \"once\" : \"page\"), n.self && f.push(\"self\"), u) {\n        var s,\n            c = [o];\n        Object.keys(u).length > 0 && c.push(u), (s = this.logger).info.apply(s, [\"Transition found [\" + f.join(\",\") + \"]\"].concat(c));\n      } else this.logger.info(\"No transition found [\" + f.join(\",\") + \"]\");\n\n      return o;\n    }, n.update = function () {\n      var t = this;\n      this.all = this.all.map(function (n) {\n        return t.T(n);\n      }).sort(function (t, n) {\n        return t.priority - n.priority;\n      }).reverse().map(function (t) {\n        return delete t.priority, t;\n      }), this.page = this.all.filter(function (t) {\n        return void 0 !== t.leave || void 0 !== t.enter;\n      }), this.once = this.all.filter(function (t) {\n        return void 0 !== t.once;\n      });\n    }, n.R = function (t, n, r, e, i) {\n      var o = !0,\n          u = !1,\n          f = t,\n          s = n.name,\n          c = s,\n          a = s,\n          h = s,\n          v = i ? f[i] : f,\n          l = \"to\" === i ? r.next : r.current;\n\n      if (i ? v && v[s] : v[s]) {\n        switch (n.type) {\n          case \"strings\":\n          default:\n            var d = Array.isArray(v[c]) ? v[c] : [v[c]];\n            l[c] && -1 !== d.indexOf(l[c]) && (u = !0), -1 === d.indexOf(l[c]) && (o = !1);\n            break;\n\n          case \"object\":\n            var m = Array.isArray(v[a]) ? v[a] : [v[a]];\n            l[a] ? (l[a].name && -1 !== m.indexOf(l[a].name) && (u = !0), -1 === m.indexOf(l[a].name) && (o = !1)) : o = !1;\n            break;\n\n          case \"function\":\n            v[h](r) ? u = !0 : o = !1;\n        }\n\n        u && (i ? (e[i] = e[i] || {}, e[i][s] = f[i][s]) : e[s] = f[s]);\n      }\n\n      return o;\n    }, n.O = function (t, n, r) {\n      var e = 0;\n      return (t[n] || t.from && t.from[n] || t.to && t.to[n]) && (e += Math.pow(10, r), t.from && t.from[n] && (e += 1), t.to && t.to[n] && (e += 2)), e;\n    }, n.T = function (t) {\n      var n = this;\n      t.priority = 0;\n      var r = 0;\n      return this.A.forEach(function (e, i) {\n        r += n.O(t, e.name, i + 1);\n      }), t.priority = r, t;\n    }, t;\n  }(),\n      ut = function () {\n    function t(t) {\n      void 0 === t && (t = []), this.logger = new l(\"@barba/core\"), this.S = !1, this.store = new ot(t);\n    }\n\n    var r = t.prototype;\n    return r.get = function (t, n) {\n      return this.store.resolve(t, n);\n    }, r.doOnce = function (t) {\n      var n = t.data,\n          r = t.transition;\n\n      try {\n        var e = function () {\n          i.S = !1;\n        },\n            i = this,\n            o = r || {};\n\n        i.S = !0;\n        var u = s(function () {\n          return Promise.resolve(i.j(\"beforeOnce\", n, o)).then(function () {\n            return Promise.resolve(i.once(n, o)).then(function () {\n              return Promise.resolve(i.j(\"afterOnce\", n, o)).then(function () {});\n            });\n          });\n        }, function (t) {\n          i.S = !1, i.logger.debug(\"Transition error [before/after/once]\"), i.logger.error(t);\n        });\n        return Promise.resolve(u && u.then ? u.then(e) : e());\n      } catch (t) {\n        return Promise.reject(t);\n      }\n    }, r.doPage = function (t) {\n      var n = t.data,\n          r = t.transition,\n          e = t.page,\n          i = t.wrapper;\n\n      try {\n        var o = function (t) {\n          if (u) return t;\n          f.S = !1;\n        },\n            u = !1,\n            f = this,\n            c = r || {},\n            a = !0 === c.sync || !1;\n\n        f.S = !0;\n        var h = s(function () {\n          function t() {\n            return Promise.resolve(f.j(\"before\", n, c)).then(function () {\n              var t = !1;\n\n              function r(r) {\n                return t ? r : Promise.resolve(f.remove(n)).then(function () {\n                  return Promise.resolve(f.j(\"after\", n, c)).then(function () {});\n                });\n              }\n\n              var o = function () {\n                if (a) return s(function () {\n                  return Promise.resolve(f.add(n, i)).then(function () {\n                    return Promise.resolve(f.j(\"beforeLeave\", n, c)).then(function () {\n                      return Promise.resolve(f.j(\"beforeEnter\", n, c)).then(function () {\n                        return Promise.resolve(Promise.all([f.leave(n, c), f.enter(n, c)])).then(function () {\n                          return Promise.resolve(f.j(\"afterLeave\", n, c)).then(function () {\n                            return Promise.resolve(f.j(\"afterEnter\", n, c)).then(function () {});\n                          });\n                        });\n                      });\n                    });\n                  });\n                }, function (t) {\n                  if (f.M(t)) throw new it(t, \"Transition error [sync]\");\n                });\n\n                var r = function (r) {\n                  return t ? r : s(function () {\n                    var t = function () {\n                      if (!1 !== o) return Promise.resolve(f.add(n, i)).then(function () {\n                        return Promise.resolve(f.j(\"beforeEnter\", n, c)).then(function () {\n                          return Promise.resolve(f.enter(n, c, o)).then(function () {\n                            return Promise.resolve(f.j(\"afterEnter\", n, c)).then(function () {});\n                          });\n                        });\n                      });\n                    }();\n\n                    if (t && t.then) return t.then(function () {});\n                  }, function (t) {\n                    if (f.M(t)) throw new it(t, \"Transition error [before/after/enter]\");\n                  });\n                },\n                    o = !1,\n                    u = s(function () {\n                  return Promise.resolve(f.j(\"beforeLeave\", n, c)).then(function () {\n                    return Promise.resolve(Promise.all([f.leave(n, c), L(e, n)]).then(function (t) {\n                      return t[0];\n                    })).then(function (t) {\n                      return o = t, Promise.resolve(f.j(\"afterLeave\", n, c)).then(function () {});\n                    });\n                  });\n                }, function (t) {\n                  if (f.M(t)) throw new it(t, \"Transition error [before/after/leave]\");\n                });\n\n                return u && u.then ? u.then(r) : r(u);\n              }();\n\n              return o && o.then ? o.then(r) : r(o);\n            });\n          }\n\n          var r = function () {\n            if (a) return Promise.resolve(L(e, n)).then(function () {});\n          }();\n\n          return r && r.then ? r.then(t) : t();\n        }, function (t) {\n          if (f.S = !1, t.name && \"BarbaError\" === t.name) throw f.logger.debug(t.label), f.logger.error(t.error), t;\n          throw f.logger.debug(\"Transition error [page]\"), f.logger.error(t), t;\n        });\n        return Promise.resolve(h && h.then ? h.then(o) : o(h));\n      } catch (t) {\n        return Promise.reject(t);\n      }\n    }, r.once = function (t, n) {\n      try {\n        return Promise.resolve(X.do(\"once\", t, n)).then(function () {\n          return n.once ? N(n.once, n)(t) : Promise.resolve();\n        });\n      } catch (t) {\n        return Promise.reject(t);\n      }\n    }, r.leave = function (t, n) {\n      try {\n        return Promise.resolve(X.do(\"leave\", t, n)).then(function () {\n          return n.leave ? N(n.leave, n)(t) : Promise.resolve();\n        });\n      } catch (t) {\n        return Promise.reject(t);\n      }\n    }, r.enter = function (t, n, r) {\n      try {\n        return Promise.resolve(X.do(\"enter\", t, n)).then(function () {\n          return n.enter ? N(n.enter, n)(t, r) : Promise.resolve();\n        });\n      } catch (t) {\n        return Promise.reject(t);\n      }\n    }, r.add = function (t, n) {\n      try {\n        return j.addContainer(t.next.container, n), X.do(\"nextAdded\", t), Promise.resolve();\n      } catch (t) {\n        return Promise.reject(t);\n      }\n    }, r.remove = function (t) {\n      try {\n        return j.removeContainer(t.current.container), X.do(\"currentRemoved\", t), Promise.resolve();\n      } catch (t) {\n        return Promise.reject(t);\n      }\n    }, r.M = function (t) {\n      return t.message ? !/Timeout error|Fetch error/.test(t.message) : !t.status;\n    }, r.j = function (t, n, r) {\n      try {\n        return Promise.resolve(X.do(t, n, r)).then(function () {\n          return r[t] ? N(r[t], r)(n) : Promise.resolve();\n        });\n      } catch (t) {\n        return Promise.reject(t);\n      }\n    }, n(t, [{\n      key: \"isRunning\",\n      get: function () {\n        return this.S;\n      },\n      set: function (t) {\n        this.S = t;\n      }\n    }, {\n      key: \"hasOnce\",\n      get: function () {\n        return this.store.once.length > 0;\n      }\n    }, {\n      key: \"hasSelf\",\n      get: function () {\n        return this.store.all.some(function (t) {\n          return \"self\" === t.name;\n        });\n      }\n    }, {\n      key: \"shouldWait\",\n      get: function () {\n        return this.store.all.some(function (t) {\n          return t.to && !t.to.route || t.sync;\n        });\n      }\n    }]), t;\n  }(),\n      ft = function () {\n    function t(t) {\n      var n = this;\n      this.names = [\"beforeLeave\", \"afterLeave\", \"beforeEnter\", \"afterEnter\"], this.byNamespace = new Map(), 0 !== t.length && (t.forEach(function (t) {\n        n.byNamespace.set(t.namespace, t);\n      }), this.names.forEach(function (t) {\n        X[t](n.L(t));\n      }));\n    }\n\n    return t.prototype.L = function (t) {\n      var n = this;\n      return function (r) {\n        var e = t.match(/enter/i) ? r.next : r.current,\n            i = n.byNamespace.get(e.namespace);\n        return i && i[t] ? N(i[t], i)(r) : Promise.resolve();\n      };\n    }, t;\n  }();\n\n  Element.prototype.matches || (Element.prototype.matches = Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector), Element.prototype.closest || (Element.prototype.closest = function (t) {\n    var n = this;\n\n    do {\n      if (n.matches(t)) return n;\n      n = n.parentElement || n.parentNode;\n    } while (null !== n && 1 === n.nodeType);\n\n    return null;\n  });\n  var st = {\n    container: null,\n    html: \"\",\n    namespace: \"\",\n    url: {\n      hash: \"\",\n      href: \"\",\n      path: \"\",\n      port: null,\n      query: {}\n    }\n  };\n  return new (function () {\n    function t() {\n      this.version = a, this.schemaPage = st, this.Logger = l, this.logger = new l(\"@barba/core\"), this.plugins = [], this.hooks = X, this.dom = j, this.helpers = _, this.history = M, this.request = I, this.url = H;\n    }\n\n    var e = t.prototype;\n    return e.use = function (t, n) {\n      var r = this.plugins;\n      r.indexOf(t) > -1 ? this.logger.warn(\"Plugin [\" + t.name + \"] already installed.\") : \"function\" == typeof t.install ? (t.install(this, n), r.push(t)) : this.logger.warn(\"Plugin [\" + t.name + '] has no \"install\" method.');\n    }, e.init = function (t) {\n      var n = void 0 === t ? {} : t,\n          e = n.transitions,\n          i = void 0 === e ? [] : e,\n          o = n.views,\n          u = void 0 === o ? [] : o,\n          f = n.schema,\n          s = void 0 === f ? S : f,\n          c = n.requestError,\n          a = n.timeout,\n          h = void 0 === a ? 2e3 : a,\n          v = n.cacheIgnore,\n          d = void 0 !== v && v,\n          m = n.prefetchIgnore,\n          p = void 0 !== m && m,\n          w = n.preventRunning,\n          b = void 0 !== w && w,\n          y = n.prevent,\n          P = void 0 === y ? null : y,\n          g = n.debug,\n          E = n.logLevel;\n      if (l.setLevel(!0 === (void 0 !== g && g) ? \"debug\" : void 0 === E ? \"off\" : E), this.logger.info(this.version), Object.keys(s).forEach(function (t) {\n        S[t] && (S[t] = s[t]);\n      }), this.$ = c, this.timeout = h, this.cacheIgnore = d, this.prefetchIgnore = p, this.preventRunning = b, this._ = this.dom.getWrapper(), !this._) throw new Error(\"[@barba/core] No Barba wrapper found\");\n      this._.setAttribute(\"aria-live\", \"polite\"), this.q();\n      var x = this.data.current;\n      if (!x.container) throw new Error(\"[@barba/core] No Barba container found\");\n\n      if (this.cache = new G(d), this.prevent = new et(p), this.transitions = new ut(i), this.views = new ft(u), null !== P) {\n        if (\"function\" != typeof P) throw new Error(\"[@barba/core] Prevent should be a function\");\n        this.prevent.add(\"preventCustom\", P);\n      }\n\n      this.history.init(x.url.href, x.namespace), this.B = this.B.bind(this), this.U = this.U.bind(this), this.D = this.D.bind(this), this.F(), this.plugins.forEach(function (t) {\n        return t.init();\n      });\n      var k = this.data;\n      k.trigger = \"barba\", k.next = k.current, k.current = r({}, this.schemaPage), this.hooks.do(\"ready\", k), this.once(k), this.q();\n    }, e.destroy = function () {\n      this.q(), this.H(), this.history.clear(), this.hooks.clear(), this.plugins = [];\n    }, e.force = function (t) {\n      window.location.assign(t);\n    }, e.go = function (t, n, r) {\n      var e;\n      if (void 0 === n && (n = \"barba\"), this.transitions.isRunning) this.force(t);else if (!(e = \"popstate\" === n ? this.history.current && this.url.getPath(this.history.current.url) === this.url.getPath(t) : this.prevent.run(\"sameUrl\", null, null, t)) || this.transitions.hasSelf) return n = this.history.change(t, n, r), r && (r.stopPropagation(), r.preventDefault()), this.page(t, n, e);\n    }, e.once = function (t) {\n      try {\n        var n = this;\n        return Promise.resolve(n.hooks.do(\"beforeEnter\", t)).then(function () {\n          function r() {\n            return Promise.resolve(n.hooks.do(\"afterEnter\", t)).then(function () {});\n          }\n\n          var e = function () {\n            if (n.transitions.hasOnce) {\n              var r = n.transitions.get(t, {\n                once: !0\n              });\n              return Promise.resolve(n.transitions.doOnce({\n                transition: r,\n                data: t\n              })).then(function () {});\n            }\n          }();\n\n          return e && e.then ? e.then(r) : r();\n        });\n      } catch (t) {\n        return Promise.reject(t);\n      }\n    }, e.page = function (t, n, e) {\n      try {\n        var i = function () {\n          var t = o.data;\n          return Promise.resolve(o.hooks.do(\"page\", t)).then(function () {\n            var n = s(function () {\n              var n = o.transitions.get(t, {\n                once: !1,\n                self: e\n              });\n              return Promise.resolve(o.transitions.doPage({\n                data: t,\n                page: u,\n                transition: n,\n                wrapper: o._\n              })).then(function () {\n                o.q();\n              });\n            }, function () {\n              0 === l.getLevel() && o.force(t.current.url.href);\n            });\n            if (n && n.then) return n.then(function () {});\n          });\n        },\n            o = this;\n\n        o.data.next.url = r({\n          href: t\n        }, o.url.parse(t)), o.data.trigger = n;\n\n        var u = o.cache.has(t) ? o.cache.update(t, {\n          action: \"click\"\n        }).request : o.cache.set(t, o.request(t, o.timeout, o.onRequestError.bind(o, n)), \"click\").request,\n            f = function () {\n          if (o.transitions.shouldWait) return Promise.resolve(L(u, o.data)).then(function () {});\n        }();\n\n        return Promise.resolve(f && f.then ? f.then(i) : i());\n      } catch (t) {\n        return Promise.reject(t);\n      }\n    }, e.onRequestError = function (t) {\n      this.transitions.isRunning = !1;\n\n      for (var n = arguments.length, r = new Array(n > 1 ? n - 1 : 0), e = 1; e < n; e++) r[e - 1] = arguments[e];\n\n      var i = r[0],\n          o = r[1],\n          u = this.cache.getAction(i);\n      return this.cache.delete(i), !(this.$ && !1 === this.$(t, u, i, o) || (\"click\" === u && this.force(i), 1));\n    }, e.prefetch = function (t) {\n      var n = this;\n      this.cache.has(t) || this.cache.set(t, this.request(t, this.timeout, this.onRequestError.bind(this, \"barba\")).catch(function (t) {\n        n.logger.error(t);\n      }), \"prefetch\");\n    }, e.F = function () {\n      !0 !== this.prefetchIgnore && (document.addEventListener(\"mouseover\", this.B), document.addEventListener(\"touchstart\", this.B)), document.addEventListener(\"click\", this.U), window.addEventListener(\"popstate\", this.D);\n    }, e.H = function () {\n      !0 !== this.prefetchIgnore && (document.removeEventListener(\"mouseover\", this.B), document.removeEventListener(\"touchstart\", this.B)), document.removeEventListener(\"click\", this.U), window.removeEventListener(\"popstate\", this.D);\n    }, e.B = function (t) {\n      var n = this,\n          r = this.I(t);\n\n      if (r) {\n        var e = this.dom.getHref(r);\n        this.prevent.checkHref(e) || this.cache.has(e) || this.cache.set(e, this.request(e, this.timeout, this.onRequestError.bind(this, r)).catch(function (t) {\n          n.logger.error(t);\n        }), \"enter\");\n      }\n    }, e.U = function (t) {\n      var n = this.I(t);\n      if (n) return this.transitions.isRunning && this.preventRunning ? (t.preventDefault(), void t.stopPropagation()) : void this.go(this.dom.getHref(n), n, t);\n    }, e.D = function (t) {\n      this.go(this.url.getHref(), \"popstate\", t);\n    }, e.I = function (t) {\n      for (var n = t.target; n && !this.dom.getHref(n);) n = n.parentNode;\n\n      if (n && !this.prevent.checkLink(n, t, this.dom.getHref(n))) return n;\n    }, e.q = function () {\n      var t = this.url.getHref(),\n          n = {\n        container: this.dom.getContainer(),\n        html: this.dom.getHtml(),\n        namespace: this.dom.getNamespace(),\n        url: r({\n          href: t\n        }, this.url.parse(t))\n      };\n      this.C = {\n        current: n,\n        next: r({}, this.schemaPage),\n        trigger: void 0\n      }, this.hooks.do(\"reset\", this.data);\n    }, n(t, [{\n      key: \"data\",\n      get: function () {\n        return this.C;\n      }\n    }, {\n      key: \"wrapper\",\n      get: function () {\n        return this._;\n      }\n    }]), t;\n  }())();\n});","map":{"version":3,"sources":["../../../node_modules/babel-plugin-transform-async-to-promises/helpers.js","../src/modules/Logger.ts","../src/defs/hooks.ts","../../../node_modules/path-to-regexp/index.js","../src/schemas/attribute.ts","../src/utils/dom.ts","../src/utils/history.ts","../src/utils/helpers.ts","../src/utils/url.ts","../src/utils/request.ts","../../../node_modules/is-promise/index.js","../src/utils/run-async.ts","../src/hooks.ts","../src/modules/Ignore.ts","../src/modules/Cache.ts","../src/modules/Prevent.ts","../src/modules/Error.ts","../src/modules/Store.ts","../src/modules/Transitions.ts","../src/modules/Views.ts","../src/polyfills/index.ts","../src/schemas/page.ts","../src/core.ts"],"names":["Symbol","iterator","asyncIterator","_catch","body","recover","result","e","then","LogLevels","_level","off","Logger","getLevel","setLevel","name","source","this","_source","error","objects","_log","console","warn","warning","info","debug","log","fn","level","apply","concat","HookMethods","pathToRegexp","regexpToFunction","parse","tokensToFunction","tokensToRegExp","DEFAULT_DELIMITER","PATH_REGEXP","RegExp","join","str","options","tokens","key","index","path","defaultDelimiter","delimiter","whitelist","undefined","pathEscaped","res","exec","m","escaped","offset","slice","length","prev","capture","group","modifier","k","c","indexOf","push","pattern","prefix","optional","repeat","escapeGroup","escapeString","substr","keys","re","pathname","params","decode","decodeURIComponent","i","split","map","value","matches","Array","flags","data","encode","encodeURIComponent","validate","token","segment","isArray","TypeError","j","test","String","replace","sensitive","groups","match","parts","strict","start","end","endsWith","route","endToken","isEndDelimited","regexpToRegexp","arrayToRegexp","stringToRegexp","schemaAttribute","container","history","namespace","prevent","wrapper","DOMParser","toString","el","outerHTML","toDocument","htmlString","_parser","parseFromString","toElement","div","document","createElement","innerHTML","getHtml","doc","documentElement","getWrapper","scope","querySelector","_attr","getContainer","removeContainer","contains","parentNode","removeChild","addContainer","existingContainer","_insertAfter","appendChild","getNamespace","ns","getAttribute","getHref","tagName","toLowerCase","href","baseVal","resolveUrl","urls","numUrls","Error","base","arguments","head","getElementsByTagName","insertBefore","firstChild","a","resolved","newNode","referenceNode","nextSibling","dom","init","url","_session","state","scroll","x","window","scrollX","y","scrollY","_states","_pointer","item","from","states","replaceState","change","trigger","_getDirection","add","size","action","_getAction","pushState","update","get","set","remove","splice","pop","clear","newStates","attr","hasAttribute","diff","Math","abs","page","next","html","nextDocument","title","Promise","requestAnimationFrame","resolve","ptr","location","getOrigin","origin","getPort","port","portString","substring","parseInt","hash","query","hashIndex","queryIndex","parseQuery","reduce","acc","clean","request","ttl","requestError","reject","xhr","XMLHttpRequest","onreadystatechange","readyState","DONE","status","responseText","statusText","ontimeout","err","onerror","open","timeout","setRequestHeader","send","obj","runAsync","func","ctx","args","async","promise","answer","isPromise","_this","Map","registered","all","forEach","_this2","hook","has","Set","chain","_this3","logger","_this4","help","hooks","Ignore","ignore","_ignoreAll","paths","_ignoreRegexes","p","checkHref","some","regex","Cache","_state","getRequest","getAction","exists","newTab","event","which","metaKey","ctrlKey","shiftKey","altKey","blank","target","corsDomain","protocol","hostname","corsPort","download","preventSelf","preventAll","Boolean","closest","sameUrl","Prevent","check","suite","tests","run","checkLink","BarbaError","label","captureStackTrace","Store","type","transitions","_rules","position","filters","once","self","filter","t","matching","active","find","valid","reverse","_check","rule","to","activeMatch","transitionType","infos","Object","_addPriority","sort","b","priority","leave","enter","transition","direction","isValid","hasMatch","strRule","objRule","fnName","current","names","_calculatePriority","ruleName","ruleIndex","pow","Transitions","store","_running","sync","doOnce","_doAsyncHook","doPage","helpers","_isTransitionError","leaveResult","values","message","Views","views","byNamespace","view","_createHook","Element","prototype","msMatchesSelector","webkitMatchesSelector","s","parentElement","nodeType","schemaPage","version","use","plugin","installedPlugins","plugins","install","schema","cacheIgnore","prefetchIgnore","preventRunning","preventCustom","logLevel","_requestCustomError","_wrapper","setAttribute","_resetData","cache","_onLinkEnter","bind","_onLinkClick","_onStateChange","_bind","onceData","destroy","_unbind","_data","force","assign","go","isRunning","getPath","hasSelf","stopPropagation","preventDefault","readyData","hasOnce","onRequestError","shouldWait","response","prefetch","_this5","addEventListener","removeEventListener","link","_getLinkElement","_this6"],"mappings":"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","sourcesContent":["// A type of promise-like that resolves synchronously and supports only one observer\nexport const _Pact = /*#__PURE__*/(function() {\n\tfunction _Pact() {}\n\t_Pact.prototype.then = function(onFulfilled, onRejected) {\n\t\tconst result = new _Pact();\n\t\tconst state = this.s;\n\t\tif (state) {\n\t\t\tconst callback = state & 1 ? onFulfilled : onRejected;\n\t\t\tif (callback) {\n\t\t\t\ttry {\n\t\t\t\t\t_settle(result, 1, callback(this.v));\n\t\t\t\t} catch (e) {\n\t\t\t\t\t_settle(result, 2, e);\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t} else {\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}\n\t\tthis.o = function(_this) {\n\t\t\ttry {\n\t\t\t\tconst value = _this.v;\n\t\t\t\tif (_this.s & 1) {\n\t\t\t\t\t_settle(result, 1, onFulfilled ? onFulfilled(value) : value);\n\t\t\t\t} else if (onRejected) {\n\t\t\t\t\t_settle(result, 1, onRejected(value));\n\t\t\t\t} else {\n\t\t\t\t\t_settle(result, 2, value);\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t_settle(result, 2, e);\n\t\t\t}\n\t\t};\n\t\treturn result;\n\t}\n\treturn _Pact;\n})();\n\n// Settles a pact synchronously\nexport function _settle(pact, state, value) {\n\tif (!pact.s) {\n\t\tif (value instanceof _Pact) {\n\t\t\tif (value.s) {\n\t\t\t\tif (state & 1) {\n\t\t\t\t\tstate = value.s;\n\t\t\t\t}\n\t\t\t\tvalue = value.v;\n\t\t\t} else {\n\t\t\t\tvalue.o = _settle.bind(null, pact, state);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tif (value && value.then) {\n\t\t\tvalue.then(_settle.bind(null, pact, state), _settle.bind(null, pact, 2));\n\t\t\treturn;\n\t\t}\n\t\tpact.s = state;\n\t\tpact.v = value;\n\t\tconst observer = pact.o;\n\t\tif (observer) {\n\t\t\tobserver(pact);\n\t\t}\n\t}\n}\n\nexport function _isSettledPact(thenable) {\n\treturn thenable instanceof _Pact && thenable.s & 1;\n}\n\n// Converts argument to a function that always returns a Promise\nexport function _async(f) {\n\treturn function() {\n\t\tfor (var args = [], i = 0; i < arguments.length; i++) {\n\t\t\targs[i] = arguments[i];\n\t\t}\n\t\ttry {\n\t\t\treturn Promise.resolve(f.apply(this, args));\n\t\t} catch(e) {\n\t\t\treturn Promise.reject(e);\n\t\t}\n\t}\n}\n\n// Awaits on a value that may or may not be a Promise (equivalent to the await keyword in ES2015, with continuations passed explicitly)\nexport function _await(value, then, direct) {\n\tif (direct) {\n\t\treturn then ? then(value) : value;\n\t}\n\tif (!value || !value.then) {\n\t\tvalue = Promise.resolve(value);\n\t}\n\treturn then ? value.then(then) : value;\n}\n\n// Awaits on a value that may or may not be a Promise, then ignores it\nexport function _awaitIgnored(value, direct) {\n\tif (!direct) {\n\t\treturn value && value.then ? value.then(_empty) : Promise.resolve();\n\t}\n}\n\n// Proceeds after a value has resolved, or proceeds immediately if the value is not thenable\nexport function _continue(value, then) {\n\treturn value && value.then ? value.then(then) : then(value);\n}\n\n// Proceeds after a value has resolved, or proceeds immediately if the value is not thenable\nexport function _continueIgnored(value) {\n\tif (value && value.then) {\n\t\treturn value.then(_empty);\n\t}\n}\n\n// Asynchronously iterate through an object that has a length property, passing the index as the first argument to the callback (even as the length property changes)\nexport function _forTo(array, body, check) {\n\tvar i = -1, pact, reject;\n\tfunction _cycle(result) {\n\t\ttry {\n\t\t\twhile (++i < array.length && (!check || !check())) {\n\t\t\t\tresult = body(i);\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.then(_cycle, reject || (reject = _settle.bind(null, pact = new _Pact(), 2)));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (pact) {\n\t\t\t\t_settle(pact, 1, result);\n\t\t\t} else {\n\t\t\t\tpact = result;\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t_settle(pact || (pact = new _Pact()), 2, e);\n\t\t}\n\t}\n\t_cycle();\n\treturn pact;\n}\n\n// Asynchronously iterate through an object's properties (including properties inherited from the prototype)\n// Uses a snapshot of the object's properties\nexport function _forIn(target, body, check) {\n\tvar keys = [];\n\tfor (var key in target) {\n\t\tkeys.push(key);\n\t}\n\treturn _forTo(keys, function(i) { return body(keys[i]); }, check);\n}\n\n// Asynchronously iterate through an object's own properties (excluding properties inherited from the prototype)\n// Uses a snapshot of the object's properties\nexport function _forOwn(target, body, check) {\n\tvar keys = [];\n\tfor (var key in target) {\n\t\tif (Object.prototype.hasOwnProperty.call(target, key)) {\n\t\t\tkeys.push(key);\n\t\t}\n\t}\n\treturn _forTo(keys, function(i) { return body(keys[i]); }, check);\n}\n\nexport const _iteratorSymbol = /*#__PURE__*/ typeof Symbol !== \"undefined\" ? (Symbol.iterator || (Symbol.iterator = Symbol(\"Symbol.iterator\"))) : \"@@iterator\";\n\n// Asynchronously iterate through an object's values\n// Uses for...of if the runtime supports it, otherwise iterates until length on a copy\nexport function _forOf(target, body, check) {\n\tif (typeof target[_iteratorSymbol] === \"function\") {\n\t\tvar iterator = target[_iteratorSymbol](), step, pact, reject;\n\t\tfunction _cycle(result) {\n\t\t\ttry {\n\t\t\t\twhile (!(step = iterator.next()).done && (!check || !check())) {\n\t\t\t\t\tresult = body(step.value);\n\t\t\t\t\tif (result && result.then) {\n\t\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresult.then(_cycle, reject || (reject = _settle.bind(null, pact = new _Pact(), 2)));\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (pact) {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t} else {\n\t\t\t\t\tpact = result;\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t_settle(pact || (pact = new _Pact()), 2, e);\n\t\t\t}\n\t\t}\n\t\t_cycle();\n\t\tif (iterator.return) {\n\t\t\tvar _fixup = function(value) {\n\t\t\t\ttry {\n\t\t\t\t\tif (!step.done) {\n\t\t\t\t\t\titerator.return();\n\t\t\t\t\t}\n\t\t\t\t} catch(e) {\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t}\n\t\t\tif (pact && pact.then) {\n\t\t\t\treturn pact.then(_fixup, function(e) {\n\t\t\t\t\tthrow _fixup(e);\n\t\t\t\t});\n\t\t\t}\n\t\t\t_fixup();\n\t\t}\n\t\treturn pact;\n\t}\n\t// No support for Symbol.iterator\n\tif (!(\"length\" in target)) {\n\t\tthrow new TypeError(\"Object is not iterable\");\n\t}\n\t// Handle live collections properly\n\tvar values = [];\n\tfor (var i = 0; i < target.length; i++) {\n\t\tvalues.push(target[i]);\n\t}\n\treturn _forTo(values, function(i) { return body(values[i]); }, check);\n}\n\nexport const _asyncIteratorSymbol = /*#__PURE__*/ typeof Symbol !== \"undefined\" ? (Symbol.asyncIterator || (Symbol.asyncIterator = Symbol(\"Symbol.asyncIterator\"))) : \"@@asyncIterator\";\n\n// Asynchronously iterate on a value using it's async iterator if present, or its synchronous iterator if missing\nexport function _forAwaitOf(target, body, check) {\n\tif (typeof target[_asyncIteratorSymbol] === \"function\") {\n\t\tvar pact = new _Pact();\n\t\tvar iterator = target[_asyncIteratorSymbol]();\n\t\titerator.next().then(_resumeAfterNext).then(void 0, _reject);\n\t\treturn pact;\n\t\tfunction _resumeAfterBody(result) {\n\t\t\tif (check && check()) {\n\t\t\t\treturn _settle(pact, 1, iterator.return ? iterator.return().then(function() { return result; }) : result);\n\t\t\t}\n\t\t\titerator.next().then(_resumeAfterNext).then(void 0, _reject);\n\t\t}\n\t\tfunction _resumeAfterNext(step) {\n\t\t\tif (step.done) {\n\t\t\t\t_settle(pact, 1);\n\t\t\t} else {\n\t\t\t\tPromise.resolve(body(step.value)).then(_resumeAfterBody).then(void 0, _reject);\n\t\t\t}\n\t\t}\n\t\tfunction _reject(error) {\n\t\t\t_settle(pact, 2, iterator.return ? iterator.return().then(function() { return error; }) : error);\n\t\t}\n\t}\n\treturn Promise.resolve(_forOf(target, function(value) { return Promise.resolve(value).then(body); }, check));\n}\n\n// Asynchronously implement a generic for loop\nexport function _for(test, update, body) {\n\tvar stage;\n\tfor (;;) {\n\t\tvar shouldContinue = test();\n\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\tshouldContinue = shouldContinue.v;\n\t\t}\n\t\tif (!shouldContinue) {\n\t\t\treturn result;\n\t\t}\n\t\tif (shouldContinue.then) {\n\t\t\tstage = 0;\n\t\t\tbreak;\n\t\t}\n\t\tvar result = body();\n\t\tif (result && result.then) {\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.s;\n\t\t\t} else {\n\t\t\t\tstage = 1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (update) {\n\t\t\tvar updateValue = update();\n\t\t\tif (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n\t\t\t\tstage = 2;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tvar pact = new _Pact();\n\tvar reject = _settle.bind(null, pact, 2);\n\t(stage === 0 ? shouldContinue.then(_resumeAfterTest) : stage === 1 ? result.then(_resumeAfterBody) : updateValue.then(_resumeAfterUpdate)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterBody(value) {\n\t\tresult = value;\n\t\tdo {\n\t\t\tif (update) {\n\t\t\t\tupdateValue = update();\n\t\t\t\tif (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n\t\t\t\t\tupdateValue.then(_resumeAfterUpdate).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tshouldContinue = test();\n\t\t\tif (!shouldContinue || (_isSettledPact(shouldContinue) && !shouldContinue.v)) {\n\t\t\t\t_settle(pact, 1, result);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.v;\n\t\t\t}\n\t\t} while (!result || !result.then);\n\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t}\n\tfunction _resumeAfterTest(shouldContinue) {\n\t\tif (shouldContinue) {\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t} else {\n\t\t\t\t_resumeAfterBody(result);\n\t\t\t}\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n\tfunction _resumeAfterUpdate() {\n\t\tif (shouldContinue = test()) {\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t} else {\n\t\t\t\t_resumeAfterTest(shouldContinue);\n\t\t\t}\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n}\n\n// Asynchronously implement a do ... while loop\nexport function _do(body, test) {\n\tvar awaitBody;\n\tdo {\n\t\tvar result = body();\n\t\tif (result && result.then) {\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.v;\n\t\t\t} else {\n\t\t\t\tawaitBody = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tvar shouldContinue = test();\n\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\tshouldContinue = shouldContinue.v;\n\t\t}\n\t\tif (!shouldContinue) {\n\t\t\treturn result;\n\t\t}\n\t} while (!shouldContinue.then);\n\tconst pact = new _Pact();\n\tconst reject = _settle.bind(null, pact, 2);\n\t(awaitBody ? result.then(_resumeAfterBody) : shouldContinue.then(_resumeAfterTest)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterBody(value) {\n\t\tresult = value;\n\t\tfor (;;) {\n\t\t\tshouldContinue = test();\n\t\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\t\tshouldContinue = shouldContinue.v;\n\t\t\t}\n\t\t\tif (!shouldContinue) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\tresult = result.v;\n\t\t\t\t} else {\n\t\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t_settle(pact, 1, result);\n\t}\n\tfunction _resumeAfterTest(shouldContinue) {\n\t\tif (shouldContinue) {\n\t\t\tdo {\n\t\t\t\tresult = body();\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tshouldContinue = test();\n\t\t\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\t\t\tshouldContinue = shouldContinue.v;\n\t\t\t\t}\n\t\t\t\tif (!shouldContinue) {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} while (!shouldContinue.then);\n\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n}\n\n// Asynchronously implement a switch statement\nexport function _switch(discriminant, cases) {\n\tvar dispatchIndex = -1;\n\tvar awaitBody;\n\touter: {\n\t\tfor (var i = 0; i < cases.length; i++) {\n\t\t\tvar test = cases[i][0];\n\t\t\tif (test) {\n\t\t\t\tvar testValue = test();\n\t\t\t\tif (testValue && testValue.then) {\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t\tif (testValue === discriminant) {\n\t\t\t\t\tdispatchIndex = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Found the default case, set it as the pending dispatch case\n\t\t\t\tdispatchIndex = i;\n\t\t\t}\n\t\t}\n\t\tif (dispatchIndex !== -1) {\n\t\t\tdo {\n\t\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\t\twhile (!body) {\n\t\t\t\t\tdispatchIndex++;\n\t\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t\t}\n\t\t\t\tvar result = body();\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tawaitBody = true;\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\t\tdispatchIndex++;\n\t\t\t} while (fallthroughCheck && !fallthroughCheck());\n\t\t\treturn result;\n\t\t}\n\t}\n\tconst pact = new _Pact();\n\tconst reject = _settle.bind(null, pact, 2);\n\t(awaitBody ? result.then(_resumeAfterBody) : testValue.then(_resumeAfterTest)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterTest(value) {\n\t\tfor (;;) {\n\t\t\tif (value === discriminant) {\n\t\t\t\tdispatchIndex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (++i === cases.length) {\n\t\t\t\tif (dispatchIndex !== -1) {\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\ttest = cases[i][0];\n\t\t\tif (test) {\n\t\t\t\tvalue = test();\n\t\t\t\tif (value && value.then) {\n\t\t\t\t\tvalue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdispatchIndex = i;\n\t\t\t}\n\t\t}\n\t\tdo {\n\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\twhile (!body) {\n\t\t\t\tdispatchIndex++;\n\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t}\n\t\t\tvar result = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\tdispatchIndex++;\n\t\t} while (fallthroughCheck && !fallthroughCheck());\n\t\t_settle(pact, 1, result);\n\t}\n\tfunction _resumeAfterBody(result) {\n\t\tfor (;;) {\n\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\tif (!fallthroughCheck || fallthroughCheck()) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdispatchIndex++;\n\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\twhile (!body) {\n\t\t\t\tdispatchIndex++;\n\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t_settle(pact, 1, result);\n\t}\n}\n\n// Asynchronously call a function and pass the result to explicitly passed continuations\nexport function _call(body, then, direct) {\n\tif (direct) {\n\t\treturn then ? then(body()) : body();\n\t}\n\ttry {\n\t\tvar result = Promise.resolve(body());\n\t\treturn then ? result.then(then) : result;\n\t} catch (e) {\n\t\treturn Promise.reject(e);\n\t}\n}\n\n// Asynchronously call a function and swallow the result\nexport function _callIgnored(body, direct) {\n\treturn _call(body, _empty, direct);\n}\n\n// Asynchronously call a function and pass the result to explicitly passed continuations\nexport function _invoke(body, then) {\n\tvar result = body();\n\tif (result && result.then) {\n\t\treturn result.then(then);\n\t}\n\treturn then(result);\n}\n\n// Asynchronously call a function and swallow the result\nexport function _invokeIgnored(body) {\n\tvar result = body();\n\tif (result && result.then) {\n\t\treturn result.then(_empty);\n\t}\n}\n\n// Asynchronously call a function and send errors to recovery continuation\nexport function _catch(body, recover) {\n\ttry {\n\t\tvar result = body();\n\t} catch(e) {\n\t\treturn recover(e);\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(void 0, recover);\n\t}\n\treturn result;\n}\n\n// Asynchronously await a promise and pass the result to a finally continuation\nexport function _finallyRethrows(body, finalizer) {\n\ttry {\n\t\tvar result = body();\n\t} catch (e) {\n\t\treturn finalizer(true, e);\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(finalizer.bind(null, false), finalizer.bind(null, true));\n\t}\n\treturn finalizer(false, result);\n}\n\n// Asynchronously await a promise and invoke a finally continuation that always overrides the result\nexport function _finally(body, finalizer) {\n\ttry {\n\t\tvar result = body();\n\t} catch (e) {\n\t\treturn finalizer();\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(finalizer, finalizer);\n\t}\n\treturn finalizer();\n}\n\n// Rethrow or return a value from a finally continuation\nexport function _rethrow(thrown, value) {\n\tif (thrown)\n\t\tthrow value;\n\treturn value;\n}\n\n// Empty function to implement break and other control flow that ignores asynchronous results\nexport function _empty() {\n}\n\n// Sentinel value for early returns in generators \nexport const _earlyReturn = /*#__PURE__*/ {};\n\n// Asynchronously call a function and send errors to recovery continuation, skipping early returns\nexport function _catchInGenerator(body, recover) {\n\treturn _catch(body, function(e) {\n\t\tif (e === _earlyReturn) {\n\t\t\tthrow e;\n\t\t}\n\t\treturn recover(e);\n\t});\n}\n\n// Asynchronous generator class; accepts the entrypoint of the generator, to which it passes itself when the generator should start\nexport const _AsyncGenerator = /*#__PURE__*/(function() {\n\tfunction _AsyncGenerator(entry) {\n\t\tthis._entry = entry;\n\t\tthis._pact = null;\n\t\tthis._resolve = null;\n\t\tthis._return = null;\n\t\tthis._promise = null;\n\t}\n\n\tfunction _wrapReturnedValue(value) {\n\t\treturn { value: value, done: true };\n\t}\n\tfunction _wrapYieldedValue(value) {\n\t\treturn { value: value, done: false };\n\t}\n\n\t_AsyncGenerator.prototype._yield = function(value) {\n\t\t// Yield the value to the pending next call\n\t\tthis._resolve(value && value.then ? value.then(_wrapYieldedValue) : _wrapYieldedValue(value));\n\t\t// Return a pact for an upcoming next/return/throw call\n\t\treturn this._pact = new _Pact();\n\t};\n\t_AsyncGenerator.prototype.next = function(value) {\n\t\t// Advance the generator, starting it if it has yet to be started\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tconst _entry = _this._entry;\n\t\t\t\tif (_entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the next call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Start the generator\n\t\t\t\t_this._entry = null;\n\t\t\t\t_this._resolve = resolve;\n\t\t\t\tfunction returnValue(value) {\n\t\t\t\t\t_this._resolve(value && value.then ? value.then(_wrapReturnedValue) : _wrapReturnedValue(value));\n\t\t\t\t\t_this._pact = null;\n\t\t\t\t\t_this._resolve = null;\n\t\t\t\t}\n\t\t\t\tvar result = _entry(_this);\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tresult.then(returnValue, function(error) {\n\t\t\t\t\t\tif (error === _earlyReturn) {\n\t\t\t\t\t\t\treturnValue(_this._return);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst pact = new _Pact();\n\t\t\t\t\t\t\t_this._resolve(pact);\n\t\t\t\t\t\t\t_this._pact = null;\n\t\t\t\t\t\t\t_this._resolve = null;\n\t\t\t\t\t\t\t_resolve(pact, 2, error);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treturnValue(result);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Generator is started and a yield expression is pending, settle it\n\t\t\t\t_this._pact = null;\n\t\t\t\t_this._resolve = resolve;\n\t\t\t\t_settle(_pact, 1, value);\n\t\t\t}\n\t\t});\n\t};\n\t_AsyncGenerator.prototype.return = function(value) {\n\t\t// Early return from the generator if started, otherwise abandons the generator\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tif (_this._entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the return call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Generator is not started, abandon it and return the specified value\n\t\t\t\t_this._entry = null;\n\t\t\t\treturn resolve(value && value.then ? value.then(_wrapReturnedValue) : _wrapReturnedValue(value));\n\t\t\t}\n\t\t\t// Settle the yield expression with a rejected \"early return\" value\n\t\t\t_this._return = value;\n\t\t\t_this._resolve = resolve;\n\t\t\t_this._pact = null;\n\t\t\t_settle(_pact, 2, _earlyReturn);\n\t\t});\n\t};\n\t_AsyncGenerator.prototype.throw = function(error) {\n\t\t// Inject an exception into the pending yield expression\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve, reject) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tif (_this._entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the throw call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Generator is not started, abandon it and return a rejected Promise containing the error\n\t\t\t\t_this._entry = null;\n\t\t\t\treturn reject(error);\n\t\t\t}\n\t\t\t// Settle the yield expression with the value as a rejection\n\t\t\t_this._resolve = resolve;\n\t\t\t_this._pact = null;\n\t\t\t_settle(_pact, 2, error);\n\t\t});\n\t};\n\n\t_AsyncGenerator.prototype[_asyncIteratorSymbol] = function() {\n\t\treturn this;\n\t};\n\t\n\treturn _AsyncGenerator;\n})();\n","/**\n * @barba/core/modules/Logger\n * <br><br>\n * ## Logger.\n *\n * - Display informations via the console\n *\n * @module core/modules/Logger\n * @preferred\n */\n\n/***/\n\n/**\n * Log levels, all lower level messages are printed\n *\n * 0. mute\n * 1. error = `console.error()`\n * 2. warning= `console.warn()`\n * 3. info = `console.info()`\n * 4. debug = `console.log()`\n */\nexport enum LogLevels {\n  off = 0,\n  error = 1,\n  warning = 2,\n  info = 3,\n  debug = 4,\n}\n\n/**\n * Global log level\n */\nlet _level: number = LogLevels.off;\n\nexport class Logger {\n  /**\n   * Get global log level.\n   */\n  public static getLevel(): number {\n    return _level;\n  }\n\n  /**\n   * Set global log level.\n   */\n  public static setLevel(name: keyof typeof LogLevels): number {\n    _level = LogLevels[name];\n\n    return _level;\n  }\n\n  /**\n   * Log \"prefix\".\n   */\n  private _source: string;\n\n  /**\n   * Creates an instance of Logger.\n   */\n  constructor(source: string) {\n    this._source = source;\n  }\n\n  /**\n   * Permanent, unremovable log.\n   */\n  // public print(...objects: any[]): void {\n  //   this._log(console.info, LogLevels.off, objects);\n  // }\n\n  /**\n   * Error log.\n   */\n  public error(...objects: any[]): void {\n    this._log(console.error, LogLevels.error, objects);\n  }\n\n  /**\n   * Warn log.\n   */\n  public warn(...objects: any[]): void {\n    this._log(console.warn, LogLevels.warning, objects);\n  }\n\n  /**\n   * Info log.\n   */\n  public info(...objects: any[]): void {\n    this._log(console.info, LogLevels.info, objects);\n  }\n\n  /**\n   * Debug log.\n   */\n  public debug(...objects: any[]): void {\n    this._log(console.log, LogLevels.debug, objects);\n  }\n\n  /**\n   * Internal logger.\n   */\n  private _log(fn: () => void, level: number, objects: any[]): void {\n    if (level <= Logger.getLevel()) {\n      fn.apply(console, ([`[${this._source}] `].concat(objects) as unknown) as [\n\n      ]);\n    }\n  }\n}\n","/**\n * @module typings/core\n */\nimport { ITransitionData, ITransitionPage, IViewData } from './index';\n\nexport type HooksBarba =\n  | 'ready'\n  | 'page'\n  | 'reset'\n  | 'currentAdded'\n  | 'currentRemoved'\n  | 'nextAdded'\n  | 'nextRemoved';\n\nexport type HooksOnce = 'beforeOnce' | 'once' | 'afterOnce';\n\nexport type HooksPage =\n  | 'before'\n  | 'beforeLeave'\n  | 'leave'\n  | 'afterLeave'\n  | 'beforeEnter'\n  | 'enter'\n  | 'afterEnter'\n  | 'after';\n\nexport type HooksBefore = 'beforeOnce' | 'beforeLeave' | 'beforeEnter';\nexport type HooksAfter = 'afterOnce' | 'afterLeave' | 'afterEnter';\n\nexport type HooksTransition = HooksOnce | HooksPage;\nexport type HooksView = HooksBefore | HooksAfter;\nexport type HooksAll = HooksBarba | HooksTransition;\n\n// Allow optional \"dynamically created\" hooks\nexport type HooksTransitionMap = { [key in HooksTransition]?: any };\n\nexport type HookFunction = (\n  data?: ITransitionData | IViewData,\n  t?: ITransitionPage\n) => Promise<void> | void;\n\nexport class HookMethods {\n  public before: (fn: HookFunction, ctx?: any) => void;\n  public beforeLeave: (fn: HookFunction, ctx?: any) => void;\n  public leave: (fn: HookFunction, ctx?: any) => void;\n  public afterLeave: (fn: HookFunction, ctx?: any) => void;\n  public beforeEnter: (fn: HookFunction, ctx?: any) => void;\n  public enter: (fn: HookFunction, ctx?: any) => void;\n  public afterEnter: (fn: HookFunction, ctx?: any) => void;\n  public after: (fn: HookFunction, ctx?: any) => void;\n}\n","/**\n * Expose `pathToRegexp`.\n */\nmodule.exports = pathToRegexp\nmodule.exports.match = match\nmodule.exports.regexpToFunction = regexpToFunction\nmodule.exports.parse = parse\nmodule.exports.compile = compile\nmodule.exports.tokensToFunction = tokensToFunction\nmodule.exports.tokensToRegExp = tokensToRegExp\n\n/**\n * Default configs.\n */\nvar DEFAULT_DELIMITER = '/'\n\n/**\n * The main path matching regexp utility.\n *\n * @type {RegExp}\n */\nvar PATH_REGEXP = new RegExp([\n  // Match escaped characters that would otherwise appear in future matches.\n  // This allows the user to escape special characters that won't transform.\n  '(\\\\\\\\.)',\n  // Match Express-style parameters and un-named parameters with a prefix\n  // and optional suffixes. Matches appear as:\n  //\n  // \":test(\\\\d+)?\" => [\"test\", \"\\d+\", undefined, \"?\"]\n  // \"(\\\\d+)\"  => [undefined, undefined, \"\\d+\", undefined]\n  '(?:\\\\:(\\\\w+)(?:\\\\(((?:\\\\\\\\.|[^\\\\\\\\()])+)\\\\))?|\\\\(((?:\\\\\\\\.|[^\\\\\\\\()])+)\\\\))([+*?])?'\n].join('|'), 'g')\n\n/**\n * Parse a string for the raw tokens.\n *\n * @param  {string}  str\n * @param  {Object=} options\n * @return {!Array}\n */\nfunction parse (str, options) {\n  var tokens = []\n  var key = 0\n  var index = 0\n  var path = ''\n  var defaultDelimiter = (options && options.delimiter) || DEFAULT_DELIMITER\n  var whitelist = (options && options.whitelist) || undefined\n  var pathEscaped = false\n  var res\n\n  while ((res = PATH_REGEXP.exec(str)) !== null) {\n    var m = res[0]\n    var escaped = res[1]\n    var offset = res.index\n    path += str.slice(index, offset)\n    index = offset + m.length\n\n    // Ignore already escaped sequences.\n    if (escaped) {\n      path += escaped[1]\n      pathEscaped = true\n      continue\n    }\n\n    var prev = ''\n    var name = res[2]\n    var capture = res[3]\n    var group = res[4]\n    var modifier = res[5]\n\n    if (!pathEscaped && path.length) {\n      var k = path.length - 1\n      var c = path[k]\n      var matches = whitelist ? whitelist.indexOf(c) > -1 : true\n\n      if (matches) {\n        prev = c\n        path = path.slice(0, k)\n      }\n    }\n\n    // Push the current path onto the tokens.\n    if (path) {\n      tokens.push(path)\n      path = ''\n      pathEscaped = false\n    }\n\n    var repeat = modifier === '+' || modifier === '*'\n    var optional = modifier === '?' || modifier === '*'\n    var pattern = capture || group\n    var delimiter = prev || defaultDelimiter\n\n    tokens.push({\n      name: name || key++,\n      prefix: prev,\n      delimiter: delimiter,\n      optional: optional,\n      repeat: repeat,\n      pattern: pattern\n        ? escapeGroup(pattern)\n        : '[^' + escapeString(delimiter === defaultDelimiter ? delimiter : (delimiter + defaultDelimiter)) + ']+?'\n    })\n  }\n\n  // Push any remaining characters.\n  if (path || index < str.length) {\n    tokens.push(path + str.substr(index))\n  }\n\n  return tokens\n}\n\n/**\n * Compile a string to a template function for the path.\n *\n * @param  {string}             str\n * @param  {Object=}            options\n * @return {!function(Object=, Object=)}\n */\nfunction compile (str, options) {\n  return tokensToFunction(parse(str, options), options)\n}\n\n/**\n * Create path match function from `path-to-regexp` spec.\n */\nfunction match (str, options) {\n  var keys = []\n  var re = pathToRegexp(str, keys, options)\n  return regexpToFunction(re, keys)\n}\n\n/**\n * Create a path match function from `path-to-regexp` output.\n */\nfunction regexpToFunction (re, keys) {\n  return function (pathname, options) {\n    var m = re.exec(pathname)\n    if (!m) return false\n\n    var path = m[0]\n    var index = m.index\n    var params = {}\n    var decode = (options && options.decode) || decodeURIComponent\n\n    for (var i = 1; i < m.length; i++) {\n      if (m[i] === undefined) continue\n\n      var key = keys[i - 1]\n\n      if (key.repeat) {\n        params[key.name] = m[i].split(key.delimiter).map(function (value) {\n          return decode(value, key)\n        })\n      } else {\n        params[key.name] = decode(m[i], key)\n      }\n    }\n\n    return { path: path, index: index, params: params }\n  }\n}\n\n/**\n * Expose a method for transforming tokens into the path function.\n */\nfunction tokensToFunction (tokens, options) {\n  // Compile all the tokens into regexps.\n  var matches = new Array(tokens.length)\n\n  // Compile all the patterns before compilation.\n  for (var i = 0; i < tokens.length; i++) {\n    if (typeof tokens[i] === 'object') {\n      matches[i] = new RegExp('^(?:' + tokens[i].pattern + ')$', flags(options))\n    }\n  }\n\n  return function (data, options) {\n    var path = ''\n    var encode = (options && options.encode) || encodeURIComponent\n    var validate = options ? options.validate !== false : true\n\n    for (var i = 0; i < tokens.length; i++) {\n      var token = tokens[i]\n\n      if (typeof token === 'string') {\n        path += token\n        continue\n      }\n\n      var value = data ? data[token.name] : undefined\n      var segment\n\n      if (Array.isArray(value)) {\n        if (!token.repeat) {\n          throw new TypeError('Expected \"' + token.name + '\" to not repeat, but got array')\n        }\n\n        if (value.length === 0) {\n          if (token.optional) continue\n\n          throw new TypeError('Expected \"' + token.name + '\" to not be empty')\n        }\n\n        for (var j = 0; j < value.length; j++) {\n          segment = encode(value[j], token)\n\n          if (validate && !matches[i].test(segment)) {\n            throw new TypeError('Expected all \"' + token.name + '\" to match \"' + token.pattern + '\"')\n          }\n\n          path += (j === 0 ? token.prefix : token.delimiter) + segment\n        }\n\n        continue\n      }\n\n      if (typeof value === 'string' || typeof value === 'number' || typeof value === 'boolean') {\n        segment = encode(String(value), token)\n\n        if (validate && !matches[i].test(segment)) {\n          throw new TypeError('Expected \"' + token.name + '\" to match \"' + token.pattern + '\", but got \"' + segment + '\"')\n        }\n\n        path += token.prefix + segment\n        continue\n      }\n\n      if (token.optional) continue\n\n      throw new TypeError('Expected \"' + token.name + '\" to be ' + (token.repeat ? 'an array' : 'a string'))\n    }\n\n    return path\n  }\n}\n\n/**\n * Escape a regular expression string.\n *\n * @param  {string} str\n * @return {string}\n */\nfunction escapeString (str) {\n  return str.replace(/([.+*?=^!:${}()[\\]|/\\\\])/g, '\\\\$1')\n}\n\n/**\n * Escape the capturing group by escaping special characters and meaning.\n *\n * @param  {string} group\n * @return {string}\n */\nfunction escapeGroup (group) {\n  return group.replace(/([=!:$/()])/g, '\\\\$1')\n}\n\n/**\n * Get the flags for a regexp from the options.\n *\n * @param  {Object} options\n * @return {string}\n */\nfunction flags (options) {\n  return options && options.sensitive ? '' : 'i'\n}\n\n/**\n * Pull out keys from a regexp.\n *\n * @param  {!RegExp} path\n * @param  {Array=}  keys\n * @return {!RegExp}\n */\nfunction regexpToRegexp (path, keys) {\n  if (!keys) return path\n\n  // Use a negative lookahead to match only capturing groups.\n  var groups = path.source.match(/\\((?!\\?)/g)\n\n  if (groups) {\n    for (var i = 0; i < groups.length; i++) {\n      keys.push({\n        name: i,\n        prefix: null,\n        delimiter: null,\n        optional: false,\n        repeat: false,\n        pattern: null\n      })\n    }\n  }\n\n  return path\n}\n\n/**\n * Transform an array into a regexp.\n *\n * @param  {!Array}  path\n * @param  {Array=}  keys\n * @param  {Object=} options\n * @return {!RegExp}\n */\nfunction arrayToRegexp (path, keys, options) {\n  var parts = []\n\n  for (var i = 0; i < path.length; i++) {\n    parts.push(pathToRegexp(path[i], keys, options).source)\n  }\n\n  return new RegExp('(?:' + parts.join('|') + ')', flags(options))\n}\n\n/**\n * Create a path regexp from string input.\n *\n * @param  {string}  path\n * @param  {Array=}  keys\n * @param  {Object=} options\n * @return {!RegExp}\n */\nfunction stringToRegexp (path, keys, options) {\n  return tokensToRegExp(parse(path, options), keys, options)\n}\n\n/**\n * Expose a function for taking tokens and returning a RegExp.\n *\n * @param  {!Array}  tokens\n * @param  {Array=}  keys\n * @param  {Object=} options\n * @return {!RegExp}\n */\nfunction tokensToRegExp (tokens, keys, options) {\n  options = options || {}\n\n  var strict = options.strict\n  var start = options.start !== false\n  var end = options.end !== false\n  var delimiter = options.delimiter || DEFAULT_DELIMITER\n  var endsWith = [].concat(options.endsWith || []).map(escapeString).concat('$').join('|')\n  var route = start ? '^' : ''\n\n  // Iterate over the tokens and create our regexp string.\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i]\n\n    if (typeof token === 'string') {\n      route += escapeString(token)\n    } else {\n      var capture = token.repeat\n        ? '(?:' + token.pattern + ')(?:' + escapeString(token.delimiter) + '(?:' + token.pattern + '))*'\n        : token.pattern\n\n      if (keys) keys.push(token)\n\n      if (token.optional) {\n        if (!token.prefix) {\n          route += '(' + capture + ')?'\n        } else {\n          route += '(?:' + escapeString(token.prefix) + '(' + capture + '))?'\n        }\n      } else {\n        route += escapeString(token.prefix) + '(' + capture + ')'\n      }\n    }\n  }\n\n  if (end) {\n    if (!strict) route += '(?:' + escapeString(delimiter) + ')?'\n\n    route += endsWith === '$' ? '$' : '(?=' + endsWith + ')'\n  } else {\n    var endToken = tokens[tokens.length - 1]\n    var isEndDelimited = typeof endToken === 'string'\n      ? endToken[endToken.length - 1] === delimiter\n      : endToken === undefined\n\n    if (!strict) route += '(?:' + escapeString(delimiter) + '(?=' + endsWith + '))?'\n    if (!isEndDelimited) route += '(?=' + escapeString(delimiter) + '|' + endsWith + ')'\n  }\n\n  return new RegExp(route, flags(options))\n}\n\n/**\n * Normalize the given path string, returning a regular expression.\n *\n * An empty array can be passed in for the keys, which will hold the\n * placeholder key descriptions. For example, using `/user/:id`, `keys` will\n * contain `[{ name: 'id', delimiter: '/', optional: false, repeat: false }]`.\n *\n * @param  {(string|RegExp|Array)} path\n * @param  {Array=}                keys\n * @param  {Object=}               options\n * @return {!RegExp}\n */\nfunction pathToRegexp (path, keys, options) {\n  if (path instanceof RegExp) {\n    return regexpToRegexp(path, keys)\n  }\n\n  if (Array.isArray(path)) {\n    return arrayToRegexp(/** @type {!Array} */ (path), keys, options)\n  }\n\n  return stringToRegexp(/** @type {string} */ (path), keys, options)\n}\n","/**\n * @barba/core/schemas\n * <br><br>\n * ## Schemas description.\n *\n * @module core/schemas\n * @preferred\n */\n\n/***/\n\n// Definitions\nimport { ISchemaAttribute } from '../defs';\n\n/**\n * See [[ISchemaAttribute]]\n */\nexport const schemaAttribute: ISchemaAttribute = {\n  container: 'container',\n  history: 'history',\n  namespace: 'namespace',\n  prefix: 'data-barba',\n  prevent: 'prevent',\n  wrapper: 'wrapper',\n};\n","/**\n * @barba/core/utils/dom\n * <br><br>\n * ## Dom utils\n *\n * - Access DOM contents\n * - DOM vs string conversions\n *\n * @module core/utils/dom\n * @preferred\n */\n\n/***/\n\nimport path from 'path';\n\n// Definitions\nimport { ISchemaAttribute, Link, Scope, Wrapper } from '../defs';\n// Schemas\nimport { schemaAttribute } from '../schemas/attribute';\n\nexport class Dom {\n  private _attr: ISchemaAttribute = schemaAttribute;\n  private _parser: DOMParser = new DOMParser();\n\n  /**\n   * Convert HTMLDocument to string.\n   */\n  public toString(el: HTMLElement): string {\n    return el.outerHTML;\n  }\n\n  /**\n   * Parse HTML string to HTMLDocument.\n   */\n  // see https://github.com/barbajs/barba/issues/362\n  // Seems that using DOMParser.parseFromString causes this issue.\n  public toDocument(htmlString: string): HTMLDocument {\n    return this._parser.parseFromString(htmlString, 'text/html');\n  }\n\n  /**\n   * Parse HTML string to DIVElement.\n   *\n   * DOMParser.parseFromString fails with img[srcset] on iOS.\n   * see https://github.com/barbajs/barba/issues/362\n   */\n  public toElement(htmlString: string): HTMLDivElement {\n    const div = document.createElement('div');\n\n    div.innerHTML = htmlString;\n    return div;\n  }\n\n  /**\n   * Get HTML content.\n   */\n  public getHtml(doc: HTMLDocument = document): string {\n    return this.toString(doc.documentElement);\n  }\n\n  /**\n   * Get full document content.\n   */\n  // getDocument(el = document.documentElement) {\n  //   return this.toStr(el);\n  // },\n\n  /**\n   * Get `[data-barba=\"wrapper\"]`.\n   */\n  public getWrapper(scope: Scope = document): Wrapper {\n    return scope.querySelector(\n      `[${this._attr.prefix}=\"${this._attr.wrapper}\"]`\n    );\n  }\n\n  /**\n   * Get `[data-barba=\"container\"]`.\n   */\n  public getContainer(scope: Scope = document): HTMLElement | null {\n    return scope.querySelector(\n      `[${this._attr.prefix}=\"${this._attr.container}\"]`\n    );\n  }\n\n  /**\n   * Remove container and store next sibling (if applicable).\n   */\n  public removeContainer(container: HTMLElement) {\n    if (document.body.contains(container)) {\n      container.parentNode.removeChild(container);\n    }\n  }\n\n  /**\n   * Add container before next sibling or at the end of the wrapper.\n   */\n  public addContainer(container: HTMLElement, wrapper: HTMLElement) {\n    const existingContainer = this.getContainer();\n\n    if (existingContainer) {\n      this._insertAfter(container, existingContainer);\n    } else {\n      wrapper.appendChild(container);\n    }\n  }\n\n  /**\n   * Get `[data-barba-namespace]`.\n   */\n  public getNamespace(scope: Scope = document): string | null {\n    const ns = scope.querySelector(\n      `[${this._attr.prefix}-${this._attr.namespace}]`\n    );\n\n    return ns\n      ? ns.getAttribute(`${this._attr.prefix}-${this._attr.namespace}`)\n      : null;\n  }\n\n  /**\n   * Get URL from `href` value.\n   */\n  public getHref(el: Link): string | null {\n    // HTML tagName is UPPERCASE, xhtml tagName keeps existing case.\n    if (el.tagName && el.tagName.toLowerCase() === 'a') {\n      // HTMLAnchorElement, full URL available\n      if (typeof el.href === 'string') {\n        return el.href;\n      }\n\n      // Probably a SVGAElement…\n      const href = el.getAttribute('href') || el.getAttribute('xlink:href');\n\n      /* istanbul ignore else */\n      if (href) {\n        // When link comes from SVG, `href` returns an object, not a string.\n        const attr: string =\n          ((href as unknown) as SVGAnimatedString).baseVal || href;\n\n        return this.resolveUrl(attr);\n      }\n    }\n    return null;\n  }\n\n  // Copyright 2014 Simon Lydell\n  // X11 (“MIT”) Licensed. (See LICENSE\n  // https://github.com/lydell/resolve-url/blob/master/resolve-url.js\n  /* istanbul ignore next */\n  public resolveUrl(...urls: string[]) {\n    const numUrls = urls.length;\n\n    if (numUrls === 0) {\n      throw new Error('resolveUrl requires at least one argument; got none.');\n    }\n\n    const base = document.createElement('base');\n    base.href = arguments[0];\n\n    if (numUrls === 1) {\n      return base.href;\n    }\n\n    const head = document.getElementsByTagName('head')[0];\n    head.insertBefore(base, head.firstChild);\n\n    const a = document.createElement('a');\n    let resolved;\n\n    for (let index = 1; index < numUrls; index++) {\n      a.href = arguments[index];\n      resolved = a.href;\n      base.href = resolved;\n    }\n\n    head.removeChild(base);\n\n    return resolved;\n  }\n\n  /**\n   * Insert node after another node.\n   */\n  private _insertAfter(newNode: Node, referenceNode: Node) {\n    referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\n  }\n}\n\nconst dom = new Dom();\n\nexport { dom };\n","import { HistoryAction, LinkEvent, Trigger } from '../defs';\n// Schemas\nimport { schemaAttribute } from '../schemas/attribute';\n\n/**\n * @barba/core/utils/history\n * <br><br>\n * ## History manager.\n *\n * - Keep track of the navigation history\n *\n * @module core/utils/history\n * @preferred\n */\n\n/**\n * State item.\n *\n * @property from\n * @property index\n */\ninterface IHistoryItem {\n  /** origin */\n  from: string;\n  /** index */\n  index: number;\n  /** states */\n  states: IStateItem[];\n}\n\n/***/\ninterface ICoords {\n  x: number;\n  y: number;\n}\n\n/**\n * History item.\n *\n * @property namespace\n * @property scroll\n * @property URL\n */\ninterface IStateItem {\n  /** namespace */\n  ns: string | undefined;\n  /** Scroll position */\n  scroll: ICoords;\n  /** URL */\n  url: string;\n}\n\nexport class History {\n  private _session: string;\n  private _states: IStateItem[] = [];\n  private _pointer = -1;\n\n  /**\n   * Init with first state.\n   */\n  public init(url: string, ns: string): void {\n    this._session = 'barba';\n    const index = 0;\n\n    const state: IStateItem = {\n      ns,\n      scroll: {\n        x: window.scrollX,\n        y: window.scrollY,\n      },\n      url,\n    };\n\n    this._states.push(state);\n    this._pointer = index;\n\n    const item: IHistoryItem = {\n      from: this._session,\n      index,\n      states: [...this._states],\n    };\n\n    window.history && window.history.replaceState(item, '', url);\n  }\n\n  public change(\n    url: string,\n    trigger: Trigger,\n    e?: LinkEvent | PopStateEvent\n  ): Trigger {\n    if (e && (e as PopStateEvent).state) {\n      // If popstate, move to existing state\n      // and get back/forward direction.\n      const { state }: { state: IHistoryItem } = e as PopStateEvent;\n      const { index } = state;\n      const diff = this._pointer - index;\n\n      trigger = this._getDirection(diff);\n\n      // Work with previous states\n      this.replace(state.states);\n      this._pointer = index;\n    } else {\n      // Add new state\n      this.add(url, trigger);\n    }\n\n    return trigger;\n  }\n\n  /**\n   * Add a new state.\n   */\n  public add(url: string, trigger: Trigger): void {\n    // If no state, it will be updated later.\n    const ns = 'tmp';\n    const index = this.size;\n    const action = this._getAction(trigger);\n    const state: IStateItem = {\n      ns,\n      scroll: {\n        x: window.scrollX,\n        y: window.scrollY,\n      },\n      url,\n    };\n\n    this._states.push(state);\n    this._pointer = index;\n\n    const item: IHistoryItem = {\n      from: this._session,\n      index,\n      states: [...this._states],\n    };\n\n    switch (action) {\n      case 'push':\n        window.history && window.history.pushState(item, '', url);\n        break;\n      case 'replace':\n        window.history && window.history.replaceState(item, '', url);\n        break;\n      /* istanbul ignore next */\n      default:\n    }\n  }\n\n  /**\n   * Update state.\n   */\n  public update(data: any, i?: number): void {\n    const index = i || this._pointer;\n    const existing = this.get(index);\n    const state: IStateItem = {\n      ...existing,\n      ...data,\n    };\n\n    this.set(index, state);\n  }\n\n  /**\n   * Remove last state.\n   */\n  public remove(i?: number): void {\n    if (i) {\n      this._states.splice(i, 1);\n    } else {\n      this._states.pop();\n    }\n\n    this._pointer--;\n  }\n\n  /**\n   * Delete all states.\n   */\n  public clear(): void {\n    this._states = [];\n    this._pointer = -1;\n  }\n\n  /**\n   * Replace all states.\n   */\n  public replace(newStates: IStateItem[]): void {\n    this._states = newStates;\n  }\n\n  /**\n   * Get state by index.\n   */\n  public get(index: number) {\n    return this._states[index];\n  }\n\n  /**\n   * Set state by index.\n   */\n  public set(i: number, state: IStateItem) {\n    return (this._states[i] = state);\n  }\n\n  /**\n   * Get the current state.\n   */\n  get current(): IStateItem {\n    return this._states[this._pointer];\n  }\n\n  /**\n   * Get the last state (top of the history stack).\n   */\n  get state(): IStateItem {\n    return this._states[this._states.length - 1];\n  }\n\n  /**\n   * Get the previous state.\n   */\n  get previous(): IStateItem | null {\n    return this._pointer < 1 ? null : this._states[this._pointer - 1];\n  }\n\n  /**\n   * Get the state size.\n   */\n  get size(): number {\n    return this._states.length;\n  }\n\n  /**\n   * Get the history action: push vs replace\n   */\n  private _getAction(trigger: Trigger): HistoryAction {\n    let action: HistoryAction = 'push';\n\n    // Manage `data-barba-history` attribute\n    // to get the right action (push vs replace).\n    const el = trigger as HTMLAnchorElement;\n    const attr = `${schemaAttribute.prefix}-${schemaAttribute.history}`;\n\n    if (el.hasAttribute && el.hasAttribute(attr)) {\n      action = el.getAttribute(attr) as HistoryAction;\n    }\n\n    return action;\n  }\n\n  /**\n   * Get the direction of popstate change\n   */\n  private _getDirection(diff: number): Trigger {\n    // Check if \"session switch\"\n    if (Math.abs(diff) > 1) {\n      // Ex 6-0 > 0 -> forward, 0-6 < 0 -> back\n      return diff > 0 ? 'forward' : 'back';\n    } else {\n      if (diff === 0) {\n        return 'popstate';\n      } else {\n        // Ex 6-5 > 0 -> back, 5-6 < 0 -> forward\n        return diff > 0 ? 'back' : 'forward';\n      }\n    }\n  }\n}\n\nconst history = new History();\n\nexport { history };\n","/**\n * @barba/core/utils/helpers\n * <br><br>\n * ## Helpers\n *\n * - Update next page data\n *\n * @module core/utils/helpers\n * @preferred\n */\n\n/***/\n\n// Third-party\nimport ptr from 'path-to-regexp';\n// Definitions\nimport { ITransitionData } from '../defs';\n// Utils\nimport { dom } from './dom';\nimport { history } from './history';\n\n/**\n * Update `data.next`, the title and the history\n */\nexport const update = async (\n  page: Promise<string | void>,\n  data: ITransitionData\n): Promise<void> => {\n  // If not already updated\n  if (!data.next.html) {\n    const html = await page;\n    const { next } = data;\n\n    if (html) {\n      // see: https://github.com/barbajs/barba/issues/362\n      // const nextDocument = dom.toDocument(html);\n      const nextDocument = dom.toElement(html);\n\n      next.namespace = dom.getNamespace(nextDocument);\n      next.container = dom.getContainer(nextDocument);\n      // see https://github.com/barbajs/barba/issues/362\n      // next.html = dom.getHtml(nextDocument);\n      // next.html = nextDocument.innerHTML;\n      next.html = html;\n\n      // Update history namespace (not available when initially set)\n      history.update({ ns: next.namespace });\n\n      // Update title.\n      const { title } = dom.toDocument(html);\n\n      document.title = title;\n    }\n  }\n};\n\n/**\n * Next tick\n */\nexport const nextTick = () =>\n  new Promise(resolve => {\n    window.requestAnimationFrame(resolve);\n    // DEV: same result?\n    // setTimeout(resolve, 0);\n  });\n\n/**\n * Turn a route string such as `/user/:name` into a regular expression.\n *\n * Used for:\n *\n * - routes to ignore\n * - route transition resolution\n *\n * @see https://www.npmjs.com/package/path-to-regexp\n */\nconst pathToRegexp = ptr;\n\nexport { pathToRegexp };\n","/**\n * @barba/core/utils/url\n * <br><br>\n * ## URL utils.\n *\n * - Collect and structure informations from URLs\n *\n * @module core/utils/url\n */\n\n/***/\n\n// Definitions\nimport { IGenericObject, IUrlBase } from '../defs';\n\n/**\n * Get location href.\n */\nexport const getHref = () => window.location.href;\n\n/**\n * Get location origin.\n */\nexport const getOrigin = () => window.location.origin;\n\n/**\n * Get port based on URL or location.\n */\nexport const getPort = (url: string = window.location.href) => parse(url).port;\n\n/**\n * Get path from URL.\n */\nexport const getPath = (url: string = window.location.href) => parse(url).path;\n\n/**\n * Get query object from URL.\n */\n// export const getQuery = (url: string): IGenericObject => parse(url).query;\n\n/**\n * Get hash from URL.\n */\n// export const getHash = (url: string): string => parse(url).hash;\n\n/**\n * Parse URL for path, query and hash and more.\n */\nexport const parse = (url: string): IUrlBase => {\n  // Port\n  let port;\n  const matches = url.match(/:\\d+/);\n\n  if (matches === null) {\n    if (/^http/.test(url)) {\n      port = 80;\n    }\n\n    if (/^https/.test(url)) {\n      port = 443;\n    }\n  } else {\n    const portString = matches[0].substring(1);\n\n    port = parseInt(portString, 10);\n  }\n\n  // Path\n  let path = url.replace(getOrigin(), '');\n  let hash;\n  let query = {};\n\n  // Hash\n  const hashIndex = path.indexOf('#');\n\n  if (hashIndex >= 0) {\n    hash = path.slice(hashIndex + 1);\n    path = path.slice(0, hashIndex);\n  }\n\n  // Query\n  const queryIndex = path.indexOf('?');\n\n  if (queryIndex >= 0) {\n    query = parseQuery(path.slice(queryIndex + 1));\n    path = path.slice(0, queryIndex);\n  }\n\n  return {\n    hash,\n    path,\n    port,\n    query,\n  };\n};\n\n/**\n * Parse a query string to object.\n */\nexport const parseQuery = (str: string) =>\n  str.split('&').reduce((acc: IGenericObject, el: string) => {\n    const [key, value] = el.split('=');\n\n    acc[key] = value;\n\n    return acc;\n  }, {});\n\n/**\n * Clean URL, remove \"hash\" and/or \"trailing slash\".\n */\nexport const clean = (url: string = window.location.href) =>\n  url.replace(/(\\/#.*|\\/|#.*)$/, '');\n","/**\n * @barba/core/utils/request\n * <br><br>\n * ## Fetch pages for transitions.\n *\n * - Includes timeout\n * - Uses Fetch API\n * - Handles errors\n *\n * @module core/utils/request\n * @preferred\n */\n\n/***/\n\n// Definitions\nimport { RequestError } from '../defs';\n\n/**\n * Init a page request.\n * Fetch the page and returns a promise with the text content.\n */\nfunction request(\n  url: string,\n  ttl: number = 2e3,\n  requestError: RequestError\n): Promise<string> {\n  return new Promise((resolve, reject) => {\n    const xhr = new XMLHttpRequest();\n\n    xhr.onreadystatechange = () => {\n      if (xhr.readyState === XMLHttpRequest.DONE) {\n        if (xhr.status === 200) {\n          resolve(xhr.responseText);\n        } else if (xhr.status) {\n          // HTTP code is not 200, reject with response.\n          const res = {\n            status: xhr.status,\n            statusText: xhr.statusText,\n          };\n          requestError(url, res);\n          reject(res);\n        }\n      }\n    };\n    xhr.ontimeout = () => {\n      const err = new Error(`Timeout error [${ttl}]`);\n      requestError(url, err);\n      reject(err);\n    };\n    xhr.onerror = () => {\n      const err = new Error(`Fetch error`);\n      requestError(url, err);\n      reject(err);\n    };\n\n    xhr.open('GET', url);\n    xhr.timeout = ttl;\n    xhr.setRequestHeader(\n      'Accept',\n      'text/html,application/xhtml+xml,application/xml'\n    );\n    xhr.setRequestHeader('x-barba', 'yes');\n    xhr.send();\n  });\n}\n\nexport { request };\n","module.exports = isPromise;\n\nfunction isPromise(obj) {\n  return !!obj && (typeof obj === 'object' || typeof obj === 'function') && typeof obj.then === 'function';\n}\n","import isPromise from 'is-promise';\n\n// https://github.com/SBoudrias/run-async\n/* istanbul ignore next */\nexport function runAsync(\n  func: (...args: any[]) => void | Promise<any>,\n  ctx: any = {}\n): (...args: any[]) => Promise<any> {\n  return (...args: any[]) => {\n    let async = false;\n\n    const promise = new Promise((resolve, reject) => {\n      // Add async to context\n      ctx.async = () => {\n        async = true;\n\n        return (err: any, value: any) => {\n          if (err) {\n            reject(err);\n          } else {\n            resolve(value);\n          }\n        };\n      };\n\n      const answer = func.apply(ctx, args as []);\n\n      if (!async) {\n        if (isPromise(answer)) {\n          (answer as Promise<any>).then(resolve, reject);\n        } else {\n          resolve(answer);\n        }\n      }\n    });\n\n    return promise;\n  };\n}\n","/**\n * @barba/core/modules/hooks\n * <br><br>\n * ## Hooks manager.\n *\n * - Register and trigger hooks\n *\n * Hooks can be easily registered:\n *\n * ```js\n * hooks.leave(callback, context);\n * ```\n *\n * @module core/modules/hooks\n * @preferred\n */\n\n/***/\n\n// Definitions\nimport { HookFunction, HookMethods, HooksAll } from './defs';\n// Modules\nimport { Logger } from './modules/Logger';\n// Utils\nimport { runAsync } from './utils';\n// Types\ninterface IHookInfos {\n  ctx: any;\n  fn: HookFunction;\n}\n\nexport class Hooks extends HookMethods {\n  /**\n   * Allow the use of `hooks[name](cb, ctx)`.\n   */\n  [key: string]: any;\n  // [key in HooksAll]?: any;\n  public logger: Logger = new Logger('@barba/core');\n  /**\n   * All available hooks.\n   *\n   * See [[HooksAll]]\n   */\n  // TODO: get hooks from defs (DRY)?\n  public all: HooksAll[] = [\n    'ready',\n    'page',\n    'reset',\n    'currentAdded',\n    'currentRemoved',\n    'nextAdded',\n    'nextRemoved',\n    'beforeOnce',\n    'once',\n    'afterOnce',\n    'before',\n    'beforeLeave',\n    'leave',\n    'afterLeave',\n    'beforeEnter',\n    'enter',\n    'afterEnter',\n    'after',\n  ];\n  /**\n   * Registered hooks.\n   *\n   * - Unique hook name\n   * - Associated data set(s) (callback + context)\n   */\n  public registered: Map<HooksAll, Set<IHookInfos>> = new Map();\n\n  constructor() {\n    super();\n    this.init();\n  }\n\n  public init() {\n    this.registered.clear();\n    this.all.forEach(hook => {\n      if (!this[hook]) {\n        this[hook] = (fn: HookFunction, ctx?: any) => {\n          if (!this.registered.has(hook)) {\n            this.registered.set(hook, new Set());\n          }\n          const set = this.registered.get(hook);\n\n          set.add({\n            ctx: ctx || {},\n            fn,\n          });\n        };\n      }\n    });\n  }\n\n  /**\n   * Do hook.\n   *\n   * Trigger registered hooks.\n   */\n  public do(name: HooksAll, ...args: any): Promise<any> {\n    if (this.registered.has(name)) {\n      // Let's start a chain of promises\n      let chain = Promise.resolve();\n\n      this.registered.get(name).forEach(hook => {\n        // Chain async hooks promisified\n        chain = chain.then(() => runAsync(hook.fn, hook.ctx)(...args));\n      });\n\n      return chain.catch(error => {\n        this.logger.debug(`Hook error [${name}]`);\n        this.logger.error(error);\n      });\n    }\n\n    return Promise.resolve();\n  }\n\n  public clear(): void {\n    this.all.forEach(hook => {\n      delete this[hook];\n    });\n\n    this.init();\n  }\n\n  /**\n   * Help, print available and registered hooks.\n   */\n  public help(): void {\n    this.logger.info(`Available hooks: ${this.all.join(',')}`);\n    const registered: string[] = [];\n    this.registered.forEach((value, key) => registered.push(key));\n    this.logger.info(`Registered hooks: ${registered.join(',')}`);\n  }\n}\n\nconst hooks = new Hooks();\n\nexport { hooks };\n","/**\n * @barba/core/modules/ignore\n * <br><br>\n * ## Manage ignore options.\n *\n * - cache\n * - prefetch\n *\n * @module core/modules/ignore\n * @preferred\n */\n\n/***/\n\n// Definitions\nimport { IgnoreOption } from '../defs';\n// Utils\nimport { pathToRegexp } from '../utils/helpers';\nimport { parse } from '../utils/url';\n\nexport class Ignore {\n  private _ignoreAll: boolean;\n  private _ignoreRegexes: RegExp[] = [];\n\n  constructor(ignore: IgnoreOption) {\n    if (typeof ignore === 'boolean') {\n      this._ignoreAll = ignore;\n    } else {\n      const paths = Array.isArray(ignore) ? ignore : [ignore];\n\n      this._ignoreRegexes = paths.map(p => pathToRegexp(p));\n    }\n  }\n\n  public checkHref(href: string): boolean {\n    if (typeof this._ignoreAll === 'boolean') {\n      return this._ignoreAll;\n    }\n\n    const { path } = parse(href);\n\n    return this._ignoreRegexes.some(regex => regex.exec(path) !== null);\n  }\n}\n","/**\n * @barba/core/modules/cache\n * <br><br>\n * ## Cache for storing URL / HTML.\n *\n * @module core/modules/cache\n * @preferred\n */\n\n/***/\n\n// Definitions\nimport { CacheAction, CacheRequest, ICacheData, IgnoreOption } from '../defs';\n// Modules\nimport { Ignore } from './Ignore';\n\nexport class Cache extends Ignore {\n  private _state: Map<string, ICacheData> = new Map();\n\n  constructor(ignore: IgnoreOption) {\n    super(ignore);\n  }\n\n  /**\n   * Set value to cache\n   */\n  public set(\n    href: string,\n    request: CacheRequest,\n    action: CacheAction\n  ): ICacheData {\n    this._state.set(href, {\n      action,\n      request,\n    });\n\n    return {\n      action,\n      request,\n    };\n  }\n\n  /**\n   * Get data from cache\n   */\n  public get(href: string): ICacheData {\n    return this._state.get(href);\n  }\n\n  /**\n   * Get request from cache\n   */\n  public getRequest(href: string): CacheRequest {\n    return this._state.get(href).request;\n  }\n\n  /**\n   * Get action from cache\n   */\n  public getAction(href: string): CacheAction {\n    return this._state.get(href).action;\n  }\n\n  /**\n   * Check if value exists into cache\n   */\n  public has(href: string): boolean {\n    /* istanbul ignore else */\n    if (this.checkHref(href)) {\n      return false;\n    }\n    return this._state.has(href);\n  }\n\n  /**\n   * Delete value from cache\n   */\n  public delete(href: string): boolean {\n    return this._state.delete(href);\n  }\n\n  /**\n   * Update cache value\n   */\n  public update(href: string, data: ICacheData): ICacheData {\n    const state = {\n      ...this._state.get(href),\n      ...data,\n    };\n    this._state.set(href, state);\n\n    return state;\n  }\n}\n","/**\n * @barba/core/modules/prevent\n * <br><br>\n * ## Prevent checks.\n *\n * - Gathers all the tests that allow Barba to work and play transitions\n *\n * @module core/modules/prevent\n * @preferred\n */\n\n/***/\n\n// Definitions\nimport { IgnoreOption, Link, PreventCheck } from '../defs';\n// Schemas\nimport { schemaAttribute } from '../schemas/attribute';\n// Utils\nimport { url } from '../utils';\n// Modules\nimport { Ignore } from './Ignore';\n\n/**\n * Make sure the browser supports `history.pushState`.\n */\nconst pushState: PreventCheck = () => !window.history.pushState;\n\n/**\n * Make sure there is an `el` and `href`.\n */\nconst exists: PreventCheck = ({ el, href }) => !el || !href;\n\n/**\n * If the user is pressing ctrl + click, the browser will open a new tab.\n */\nconst newTab: PreventCheck = ({ event }) =>\n  (event as KeyboardEvent).which > 1 ||\n  (event as KeyboardEvent).metaKey ||\n  (event as KeyboardEvent).ctrlKey ||\n  (event as KeyboardEvent).shiftKey ||\n  (event as KeyboardEvent).altKey;\n\n/**\n * If the link has `_blank` target.\n */\nconst blank: PreventCheck = ({ el }) =>\n  el.hasAttribute('target') && (el as Link).target === '_blank';\n\n/**\n * If the domain is the same (in order to avoid pushState cross origin security problem).\n * Note: SVGAElement do not have `protocol` neither `hostname` properties.\n */\nconst corsDomain: PreventCheck = ({ el }) =>\n  ((el as HTMLAnchorElement).protocol !== undefined &&\n    window.location.protocol !== (el as HTMLAnchorElement).protocol) ||\n  ((el as HTMLAnchorElement).hostname !== undefined &&\n    window.location.hostname !== (el as HTMLAnchorElement).hostname);\n\n/**\n * If the port is the same.\n * Note: SVGAElement do not have `port` property.\n */\nconst corsPort: PreventCheck = ({ el }) =>\n  (el as HTMLAnchorElement).port !== undefined &&\n  url.getPort() !== url.getPort((el as HTMLAnchorElement).href);\n\n/**\n * If the link has download attribute.\n */\nconst download: PreventCheck = ({ el }) =>\n  el.getAttribute && typeof el.getAttribute('download') === 'string';\n\n/**\n * If the links contains [data-barba-prevent] or [data-barba-prevent=\"self\"].\n */\nconst preventSelf: PreventCheck = ({ el }) =>\n  el.hasAttribute(`${schemaAttribute.prefix}-${schemaAttribute.prevent}`);\n\n/**\n * If some link ancestor contains [data-barba-prevent=\"all\"].\n */\nconst preventAll: PreventCheck = ({ el }) =>\n  Boolean(\n    el.closest(`[${schemaAttribute.prefix}-${schemaAttribute.prevent}=\"all\"]`)\n  );\n\n/**\n * If the link is the current URL.\n *\n * > Not in the test suite.\n */\nconst sameUrl: PreventCheck = ({ href }) =>\n  url.clean(href) === url.clean() && url.getPort(href) === url.getPort();\n\nexport class Prevent extends Ignore {\n  public suite: string[] = [];\n  public tests: Map<string, PreventCheck> = new Map();\n\n  constructor(ignore: IgnoreOption) {\n    super(ignore);\n    this.init();\n  }\n\n  public init(): void {\n    // Add defaults\n    this.add('pushState', pushState);\n    this.add('exists', exists);\n    this.add('newTab', newTab);\n    this.add('blank', blank);\n    this.add('corsDomain', corsDomain);\n    this.add('corsPort', corsPort);\n    this.add('download', download);\n    this.add('preventSelf', preventSelf);\n    this.add('preventAll', preventAll);\n\n    // Outside of the test suite\n    this.add('sameUrl', sameUrl, false);\n  }\n\n  public add(name: string, check: PreventCheck, suite: boolean = true): void {\n    this.tests.set(name, check);\n    suite && this.suite.push(name);\n  }\n\n  /**\n   * Run individual test\n   */\n  public run(name: string, el: Link, event: Event, href: string): boolean {\n    return this.tests.get(name)({\n      el,\n      event,\n      href,\n    });\n  }\n\n  /**\n   * Run test suite\n   */\n  public checkLink(el: Link, event: Event, href: string): boolean {\n    return this.suite.some(name => this.run(name, el, event, href));\n  }\n}\n","// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error\nexport class BarbaError extends Error {\n  /* istanbul ignore next */\n  constructor(\n    public error: Error,\n    public label = 'Barba error',\n    ...params: any[]\n  ) {\n    // Pass remaining arguments (including vendor specific ones) to parent constructor\n    super(...params);\n\n    // Maintains proper stack trace for where our error was thrown (only available on V8)\n    /* istanbul ignore else */\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, BarbaError);\n    }\n\n    this.name = 'BarbaError';\n  }\n}\n","/**\n * @barba/core/modules/store\n * <br><br>\n * ## Transitions store.\n *\n * - Resolve transition\n * - Manage rules\n *\n * @module core/modules/store\n * @preferred\n */\n\n/***/\n\n// Definitions\nimport {\n  IRule,\n  IRules,\n  ITransitionData,\n  ITransitionFilters,\n  ITransitionOnce,\n  ITransitionPage,\n  RuleName,\n} from '../defs';\n\n// Modules\nimport { Logger } from './Logger';\n\nexport class Store {\n  public logger: Logger = new Logger('@barba/core');\n  /**\n   * All registered transitions.\n   */\n  public all: ITransitionPage[] = [];\n  /**\n   * \"Page only\" registered transitions.\n   */\n  public page: ITransitionPage[] = [];\n  /**\n   * \"Once only\" registered transitions.\n   */\n  public once: ITransitionOnce[] = [];\n  /**\n   * Rules for transition resolution.\n   *\n   * Defaults:\n   *\n   * - namespace\n   * - custom\n   */\n  private _rules: IRule[] = [\n    {\n      name: 'namespace',\n      type: 'strings',\n    },\n    {\n      name: 'custom',\n      type: 'function',\n    },\n  ];\n\n  /**\n   * Init store.\n   */\n  constructor(transitions: ITransitionPage[] = []) {\n    /* istanbul ignore else */\n    if (transitions) {\n      // TODO: add check for valid transitions? criteria? (once || enter && leave)\n      this.all = this.all.concat(transitions);\n    }\n    this.update();\n  }\n\n  /**\n   * Add rule or transition.\n   */\n  public add(type: 'rule' | 'transition', data: any): void {\n    switch (type) {\n      case 'rule':\n        // TODO: check for valid rule\n        this._rules.splice(data.position || 0, 0, data.value);\n        break;\n      case 'transition':\n      default:\n        // TODO: check for valid transition\n        this.all.push(data);\n        break;\n    }\n\n    this.update();\n  }\n\n  /**\n   * Resolve transition.\n   */\n  public resolve(\n    data: ITransitionData,\n    filters: ITransitionFilters = {}\n  ): ITransitionOnce | ITransitionPage {\n    // Filter on \"once\"\n    let transitions = filters.once ? this.once : this.page;\n\n    // Filter on \"self\"\n    if (filters.self) {\n      transitions = transitions.filter(t => t.name && t.name === 'self');\n    } else {\n      transitions = transitions.filter(t => !t.name || t.name !== 'self');\n    }\n\n    // All matching transition infos\n    const matching = new Map();\n\n    // Active = first of valid transitions\n    // sorted by directions (from/to, from || to, …)\n    const active = transitions.find(t => {\n      let valid = true;\n      const match = {};\n\n      if (filters.self && t.name === 'self') {\n        return true;\n      }\n\n      // Check rules\n      this._rules.reverse().forEach(rule => {\n        if (valid) {\n          valid = this._check(t, rule, data, match);\n          // From/to check\n          if (t.from && t.to) {\n            valid =\n              this._check(t, rule, data, match, 'from') &&\n              this._check(t, rule, data, match, 'to');\n          }\n          if (t.from && !t.to) {\n            valid = this._check(t, rule, data, match, 'from');\n          }\n          if (!t.from && t.to) {\n            valid = this._check(t, rule, data, match, 'to');\n          }\n        }\n      });\n\n      matching.set(t, match);\n\n      return valid;\n    });\n\n    const activeMatch = matching.get(active);\n    const transitionType = [];\n    if (filters.once) {\n      transitionType.push('once');\n    } else {\n      transitionType.push('page');\n    }\n    if (filters.self) {\n      transitionType.push('self');\n    }\n\n    if (activeMatch) {\n      // Log resolved transition\n      const infos: any[] = [active];\n      // Log if matching criteria\n      Object.keys(activeMatch).length > 0 && infos.push(activeMatch);\n\n      this.logger.info(\n        `Transition found [${transitionType.join(',')}]`,\n        ...infos\n      );\n    } else {\n      this.logger.info(`No transition found [${transitionType.join(',')}]`);\n    }\n\n    return active;\n  }\n\n  /**\n   * ### Update store.\n   *\n   * - Reorder transition by priorities\n   * - Get wait indicator\n   * - Get once transitions\n   */\n  public update(): void {\n    // Reorder by priorities\n    this.all = this.all\n      .map(t => this._addPriority(t))\n      .sort((a, b) => a.priority - b.priority)\n      .reverse()\n      .map(t => {\n        delete t.priority;\n\n        return t;\n      });\n    this.page = this.all.filter(\n      t => t.leave !== undefined || t.enter !== undefined\n    ) as ITransitionPage[];\n    this.once = this.all.filter(t => t.once !== undefined) as ITransitionOnce[];\n  }\n\n  /**\n   * ### Check if transition apply.\n   *\n   * Based on rule, page data and optional direction:\n   *\n   * 1. transition has no rule \"property\":\n   *    - always returns true\n   * 2. transition has rule \"property\":\n   *     - \"strings\" should be present on both side (transition + page) and match\n   *     - \"function\" should return true\n   */\n  private _check(\n    transition: ITransitionPage,\n    rule: IRule,\n    data: ITransitionData,\n    match: any,\n    direction?: 'from' | 'to'\n  ): boolean {\n    let isValid = true;\n    let hasMatch = false;\n    const t = transition;\n    const { name, type } = rule;\n    const strRule = name as IRules['strings'];\n    const objRule = name as IRules['object'];\n    const fnName = name as IRules['function'];\n    const base = direction ? t[direction] : t; // = t || t.from || t.to\n    const page = direction === 'to' ? data.next : data.current; // = current || next\n    const exist = direction ? base && base[name] : base[name];\n\n    // If transition rule exists\n    if (exist) {\n      switch (type) {\n        case 'strings':\n        default: {\n          // Array support\n          const names: string[] = Array.isArray(base[strRule])\n            ? (base[strRule] as string[])\n            : [base[strRule] as string];\n\n          // For matching, prop should be present on both sides and match\n          if (page[strRule] && names.indexOf(page[strRule]) !== -1) {\n            hasMatch = true;\n          }\n          // If transition prop is different from current, not valid\n          if (names.indexOf(page[strRule]) === -1) {\n            isValid = false;\n          }\n          break;\n        }\n\n        case 'object': {\n          // Array support\n          const names: string[] = Array.isArray(base[objRule])\n            ? (base[objRule] as string[])\n            : [base[objRule] as string];\n\n          // For matching, prop should be present on both sides and match\n          if (page[objRule]) {\n            if (\n              page[objRule].name &&\n              names.indexOf(page[objRule].name) !== -1\n            ) {\n              hasMatch = true;\n            }\n            // If transition prop is different from current, not valid\n            if (names.indexOf(page[objRule].name) === -1) {\n              isValid = false;\n            }\n          } else {\n            isValid = false;\n          }\n          break;\n        }\n\n        case 'function':\n          if (base[fnName](data)) {\n            hasMatch = true;\n          } else {\n            isValid = false;\n          }\n          break;\n      }\n\n      if (hasMatch) {\n        if (direction) {\n          match[direction] = match[direction] || {};\n          match[direction][name] = t[direction][name];\n        } else {\n          match[name] = t[name];\n        }\n      }\n    }\n\n    return isValid;\n  }\n\n  /**\n   * ### Calculate transition priority.\n   *\n   * Based on:\n   *\n   * - rule \"position\" (index) give tens, hundreds, thousands, …\n   * - from/to properties give units (0, 1 or 2)\n   */\n  private _calculatePriority(\n    t: ITransitionPage,\n    ruleName: RuleName,\n    ruleIndex: number\n  ): number {\n    let priority = 0;\n\n    if (\n      t[ruleName] ||\n      (t.from && t.from[ruleName]) ||\n      (t.to && t.to[ruleName])\n    ) {\n      priority += Math.pow(10, ruleIndex);\n\n      if (t.from && t.from[ruleName]) {\n        priority += 1;\n      }\n      if (t.to && t.to[ruleName]) {\n        priority += 2;\n      }\n    }\n\n    return priority;\n  }\n\n  private _addPriority(t: ITransitionPage): ITransitionPage {\n    t.priority = 0;\n    let priority = 0;\n\n    this._rules.forEach((rule, i) => {\n      const { name } = rule;\n      const index = i + 1;\n\n      priority += this._calculatePriority(t, name, index);\n    });\n\n    t.priority = priority;\n\n    return t;\n  }\n}\n","/**\n * @barba/core/modules/transitions\n * <br><br>\n * ## Transitions manager.\n *\n * - Handle hooks and transition lifecycle\n *\n * @module core/modules/transitions\n * @preferred\n */\n\n/***/\n\n// Definitions\nimport {\n  HooksTransition,\n  HooksTransitionMap,\n  ITransitionData,\n  ITransitionFilters,\n  ITransitionOnce,\n  ITransitionPage,\n  Wrapper,\n} from '../defs';\n// Hooks\nimport { hooks } from '../hooks';\n// Utils\nimport { dom, helpers, runAsync } from '../utils';\n// Modules\nimport { BarbaError } from './Error';\nimport { Logger } from './Logger';\nimport { Store } from './Store';\n\nexport class Transitions {\n  public logger: Logger = new Logger('@barba/core');\n  public store: Store;\n  private _running: boolean = false;\n\n  constructor(transitions: ITransitionPage[] = []) {\n    this.store = new Store(transitions);\n  }\n\n  /**\n   * Get resolved transition\n   *\n   * - based on data\n   */\n  public get(\n    data: ITransitionData,\n    filters?: ITransitionFilters\n  ): ITransitionOnce | ITransitionPage {\n    return this.store.resolve(data, filters);\n  }\n\n  /**\n   * Animation running status.\n   */\n  get isRunning(): boolean {\n    return this._running;\n  }\n  set isRunning(status: boolean) {\n    this._running = status;\n  }\n\n  /**\n   * Check for registered once transition(s).\n   */\n  get hasOnce(): boolean {\n    return this.store.once.length > 0;\n  }\n\n  /**\n   * Check for registered self transition.\n   */\n  get hasSelf(): boolean {\n    return this.store.all.some(t => t.name === 'self');\n  }\n\n  /**\n   * ### Wait indicator.\n   *\n   * Tells Barba to get next page data<br>\n   * before starting the resolution<br>\n   * because some registered transitions need<br>\n   * next page data to be resolved (eg: `sync: true`, `to: { namespace }`, …)\n   */\n  get shouldWait(): boolean {\n    return this.store.all.some(t => (t.to && !t.to.route) || t.sync);\n  }\n\n  /**\n   * ### Do \"once\" transition.\n   *\n   * Hooks: see [[HooksOnce]].\n   */\n  public async doOnce({\n    data,\n    transition,\n  }: {\n    data: ITransitionData;\n    transition: ITransitionOnce;\n  }) {\n    const t = transition || {};\n    this._running = true;\n\n    try {\n      await this._doAsyncHook('beforeOnce', data, t);\n      await this.once(data, t);\n      await this._doAsyncHook('afterOnce', data, t);\n    } catch (error) {\n      this._running = false;\n\n      this.logger.debug('Transition error [before/after/once]');\n      this.logger.error(error);\n    }\n\n    this._running = false;\n  }\n\n  /**\n   * ### Do \"page\" transition.\n   *\n   * Hooks: see [[HooksPage]].\n   *\n   * `sync: false` (default) order:\n   *\n   * 1. before\n   * 2. beforeLeave\n   * 3. leave\n   * 4. afterLeave\n   * 5. beforeEnter\n   * 6. enter\n   * 7. afterEnter\n   * 8. after\n   *\n   * `sync: true` order:\n   *\n   * 1. before\n   * 2. beforeLeave\n   * 3. beforeEnter\n   * 4. leave & enter\n   * 5. afterLeave\n   * 6. afterEnter\n   * 7. after\n   */\n  public async doPage({\n    data,\n    transition,\n    page,\n    wrapper,\n  }: {\n    data: ITransitionData;\n    transition: ITransitionPage;\n    page: Promise<string | void>;\n    wrapper: Wrapper;\n  }) {\n    const t = transition || {};\n    const sync = t.sync === true || false;\n\n    this._running = true;\n\n    try {\n      // Check sync mode, wait for next content\n      if (sync) {\n        await helpers.update(page, data);\n      }\n\n      await this._doAsyncHook('before', data, t);\n\n      if (sync) {\n        try {\n          await this.add(data, wrapper);\n          // Before actions\n          await this._doAsyncHook('beforeLeave', data, t);\n          await this._doAsyncHook('beforeEnter', data, t);\n\n          // Actions\n          await Promise.all([this.leave(data, t), this.enter(data, t)]);\n\n          // After actions\n          await this._doAsyncHook('afterLeave', data, t);\n          await this._doAsyncHook('afterEnter', data, t);\n        } catch (error) {\n          // this.logger.debug('Transition error [sync]');\n          // this.logger.error(error);\n          if (this._isTransitionError(error)) {\n            throw new BarbaError(error, 'Transition error [sync]');\n          }\n        }\n      } else {\n        let leaveResult: any = false;\n\n        try {\n          // Leave\n          await this._doAsyncHook('beforeLeave', data, t);\n\n          leaveResult = await Promise.all([\n            this.leave(data, t),\n            helpers.update(page, data),\n          ]).then(values => values[0]);\n\n          await this._doAsyncHook('afterLeave', data, t);\n\n          // TODO: check here \"valid\" page result\n          // before going further\n        } catch (error) {\n          // this.logger.debug('Transition error [before/after/leave]');\n          // this.logger.error(error);\n          if (this._isTransitionError(error)) {\n            throw new BarbaError(\n              error,\n              'Transition error [before/after/leave]'\n            );\n          }\n        }\n\n        try {\n          // Enter\n          /* istanbul ignore else */\n          if (leaveResult !== false) {\n            await this.add(data, wrapper);\n\n            await this._doAsyncHook('beforeEnter', data, t);\n            await this.enter(data, t, leaveResult);\n            await this._doAsyncHook('afterEnter', data, t);\n          }\n        } catch (error) {\n          // this.logger.debug('Transition error [before/after/enter]');\n          // this.logger.error(error);\n          if (this._isTransitionError(error)) {\n            throw new BarbaError(\n              error,\n              'Transition error [before/after/enter]'\n            );\n          }\n        }\n      }\n\n      // Remove current contaienr\n      await this.remove(data);\n\n      await this._doAsyncHook('after', data, t);\n    } catch (error) {\n      this._running = false;\n\n      // If \"custom/specific\" barba error.\n      /* istanbul ignore else */\n      if (error.name && error.name === 'BarbaError') {\n        this.logger.debug(error.label);\n        this.logger.error(error.error);\n\n        throw error;\n      }\n\n      this.logger.debug('Transition error [page]');\n      this.logger.error(error);\n\n      throw error;\n    }\n\n    this._running = false;\n  }\n\n  /**\n   * Once hook + async \"once\" transition.\n   */\n  public async once(data: ITransitionData, t: ITransitionOnce): Promise<void> {\n    await hooks.do('once', data, t);\n\n    return t.once ? runAsync(t.once, t)(data) : Promise.resolve();\n  }\n\n  /**\n   * Leave hook + async \"leave\" transition.\n   */\n  public async leave(data: ITransitionData, t: ITransitionPage): Promise<any> {\n    await hooks.do('leave', data, t);\n\n    return t.leave ? runAsync(t.leave, t)(data) : Promise.resolve();\n  }\n\n  /**\n   * Enter hook + async \"enter\" transition.\n   */\n  public async enter(\n    data: ITransitionData,\n    t: ITransitionPage,\n    leaveResult?: any\n  ): Promise<void> {\n    await hooks.do('enter', data, t);\n\n    return t.enter\n      ? runAsync(t.enter, t)(data, leaveResult)\n      : Promise.resolve();\n  }\n\n  /**\n   * Add next container.\n   */\n  public async add(data: ITransitionData, wrapper: Wrapper): Promise<void> {\n    dom.addContainer(data.next.container, wrapper);\n    hooks.do('nextAdded', data);\n  }\n\n  /**\n   * Remove current container.\n   */\n  public async remove(data: ITransitionData): Promise<void> {\n    dom.removeContainer(data.current.container);\n    hooks.do('currentRemoved', data);\n  }\n\n  private _isTransitionError(error: any) {\n    if (error.message) {\n      // Errors from request\n      return !/Timeout error|Fetch error/.test(error.message);\n    }\n\n    if (error.status) {\n      // Errors from request\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Do hooks + async transition methods.\n   */\n  private async _doAsyncHook(\n    hook: HooksTransition,\n    data: ITransitionData,\n    t: HooksTransitionMap\n  ): Promise<void> {\n    await hooks.do(hook, data, t);\n\n    return t[hook] ? runAsync(t[hook], t)(data) : Promise.resolve();\n  }\n}\n","/**\n * @barba/core/modules/views\n * <br><br>\n * ## Views manager.\n *\n * @module core/modules/views\n * @preferred\n */\n\n/***/\n\n// Definitions\nimport { HooksView, IView, IViewData } from '../defs';\n// Hooks\nimport { hooks } from '../hooks';\n// Utils\nimport { runAsync } from '../utils';\n// Types\ntype Hook = (data: IViewData) => Promise<void>;\n\nexport class Views {\n  /**\n   * Available hook names for views.\n   */\n  public names: HooksView[] = [\n    'beforeLeave',\n    'afterLeave',\n    'beforeEnter',\n    'afterEnter',\n  ];\n  /**\n   * Registered views by namespace.\n   */\n  public byNamespace: Map<string, IView> = new Map();\n\n  /**\n   * Init views.\n   */\n  constructor(views: IView[]) {\n    if (views.length === 0) {\n      return;\n    }\n\n    // TODO: add check\n    // for valid views? criteria? (namespace property, string ?)\n    // or duplicate\n    views.forEach(view => {\n      this.byNamespace.set(view.namespace, view);\n    });\n\n    this.names.forEach(name => {\n      hooks[name](this._createHook(name));\n    });\n  }\n\n  /**\n   * Create the hook method.\n   *\n   * - get view based on namespace\n   * - execute callback with transition data\n   */\n  private _createHook(name: HooksView): Hook {\n    return data => {\n      const { namespace } = name.match(/enter/i) ? data.next : data.current;\n      const view = this.byNamespace.get(namespace);\n\n      // TODO: manage self…\n      // if (view && data.trigger !== 'self') {\n      if (view && view[name]) {\n        return runAsync(view[name], view)(data);\n      }\n\n      return Promise.resolve();\n    };\n  }\n}\n","// Element.prototype.matches polyfill\n// https://developer.mozilla.org/en-US/docs/Web/API/Element/matches#Polyfill\nif (!Element.prototype.matches) {\n  Element.prototype.matches =\n    (Element as any).prototype.msMatchesSelector ||\n    Element.prototype.webkitMatchesSelector;\n}\n\n// Element.prototype.closest polyfill\n// https://developer.mozilla.org/en-US/docs/Web/API/Element/closest#Polyfill\nif (!Element.prototype.closest) {\n  Element.prototype.closest = function closest(s: string) {\n    let el = this;\n\n    do {\n      if (el.matches(s)) {\n        return el;\n      }\n\n      el = (el.parentElement || el.parentNode) as Element;\n    } while (el !== null && el.nodeType === 1);\n\n    return null;\n  };\n}\n","/**\n * @module core/schemas\n */\n\n// Definitions\nimport { ISchemaPage } from '../defs';\n\n/**\n * See [[ISchemaPage]]\n */\nexport const schemaPage: ISchemaPage = {\n  container: null,\n  html: '',\n  namespace: '',\n  url: {\n    hash: '',\n    href: '',\n    path: '',\n    port: null,\n    query: {},\n  },\n};\n","/**\n * @barba/core\n * <br><br>\n * ## Barba core object\n *\n * Main methods:\n *\n * - `.init()` for initialization with options\n * - `.use()` for plugins\n *\n * @module core\n */\n\n/***/\n\nimport { version } from '../package.json';\n// Definitions\nimport {\n  IBarbaOptions,\n  IBarbaPlugin,\n  IgnoreOption,\n  ISchemaPage,\n  ITransitionData,\n  ITransitionOnce,\n  ITransitionPage,\n  Link,\n  LinkEvent,\n  RequestCustomError,\n  RequestErrorOrResponse,\n  SchemaAttributeValues,\n  Trigger,\n  Wrapper,\n} from './defs';\n// Hooks\nimport { hooks } from './hooks';\n// Modules\nimport { Cache } from './modules/Cache';\nimport { Logger } from './modules/Logger';\nimport { Prevent } from './modules/Prevent';\nimport { Transitions } from './modules/Transitions';\nimport { Views } from './modules/Views';\n// Polyfills\nimport './polyfills';\n// Schemas\nimport { schemaAttribute } from './schemas/attribute';\nimport { schemaPage } from './schemas/page';\n// Utils\nimport { dom, helpers, history, request, url } from './utils';\n\nexport class Core {\n  /**\n   * Version.\n   */\n  public version: string = version;\n  /**\n   * Schemas.\n   */\n  public schemaPage: ISchemaPage = schemaPage;\n  /**\n   * Logger class, allows plugins to create Logger.\n   */\n  public Logger: typeof Logger = Logger;\n  /**\n   * Barba logger.\n   */\n  public logger: Logger = new Logger('@barba/core');\n  /**\n   * Plugins.\n   */\n  public plugins: Array<IBarbaPlugin<any>> = [];\n  /**\n   * Options\n   */\n  public timeout: number;\n  public cacheIgnore: IgnoreOption;\n  public prefetchIgnore: IgnoreOption;\n  public preventRunning: boolean;\n  /**\n   * Hooks\n   */\n  public hooks = hooks;\n  /**\n   * Modules.\n   */\n  // public history: History;\n  public cache: Cache;\n  public prevent: Prevent;\n  public transitions: Transitions;\n  public views: Views;\n  /**\n   * Utils.\n   */\n  public dom = dom;\n  public helpers = helpers;\n  public history = history;\n  public request = request;\n  public url = url;\n\n  private _data: ITransitionData;\n  private _requestCustomError: RequestCustomError;\n  private _wrapper: Wrapper;\n\n  /**\n   * ### Init plugin with options.\n   *\n   * See [[IBarbaPlugin]] for more details.\n   */\n  public use<T>(plugin: IBarbaPlugin<T>, options?: T): void {\n    const installedPlugins = this.plugins;\n\n    // Plugin installation\n    if (installedPlugins.indexOf(plugin) > -1) {\n      this.logger.warn(`Plugin [${plugin.name}] already installed.`);\n\n      return;\n    }\n\n    if (typeof plugin.install !== 'function') {\n      this.logger.warn(`Plugin [${plugin.name}] has no \"install\" method.`);\n\n      return;\n    }\n\n    plugin.install(this, options);\n    installedPlugins.push(plugin);\n  }\n\n  /**\n   * ### Init barba with options.\n   *\n   * See [[IBarbaOptions]] for more details.\n   *\n   * Default values are:\n   *\n   * - transitions: `[]`\n   * - views: `[]`\n   * - schema: [[SchemaAttribute]]\n   * - timeout: `2e3`\n   * - cacheIgnore: `false`\n   * - prefetchIgnore: `false`\n   * - preventRunning: `false`\n   * - prevent: `null`,\n   * - debug: `false`\n   * - logLevel: `'debug'`\n   */\n  public init(\n    /** @ignore */ {\n      transitions = [],\n      views = [],\n      schema = schemaAttribute,\n      requestError,\n      timeout = 2e3,\n      cacheIgnore = false,\n      prefetchIgnore = false,\n      /* istanbul ignore next */\n      preventRunning = false,\n      prevent: preventCustom = null,\n      debug = false,\n      logLevel = 'off',\n    }: IBarbaOptions = {}\n  ) {\n    // 0. Set logger level and print version\n    Logger.setLevel(debug === true ? 'debug' : logLevel);\n    this.logger.info(this.version);\n\n    // 1. Manage options\n    Object.keys(schema).forEach(k => {\n      const attr = k as SchemaAttributeValues;\n\n      /* istanbul ignore else */\n      if (schemaAttribute[attr]) {\n        schemaAttribute[attr] = schema[attr];\n      }\n    });\n    this._requestCustomError = requestError;\n    this.timeout = timeout;\n    this.cacheIgnore = cacheIgnore;\n    this.prefetchIgnore = prefetchIgnore;\n    this.preventRunning = preventRunning;\n\n    // 2. Get and check wrapper\n    this._wrapper = this.dom.getWrapper();\n    if (!this._wrapper) {\n      throw new Error('[@barba/core] No Barba wrapper found');\n    }\n    this._wrapper.setAttribute('aria-live', 'polite'); // A11y\n\n    // 3. Init pages (get \"current\" data)\n    this._resetData();\n\n    const { current } = this.data;\n\n    if (!current.container) {\n      throw new Error('[@barba/core] No Barba container found');\n    }\n\n    // 4. Init other modules\n    this.cache = new Cache(cacheIgnore);\n    this.prevent = new Prevent(prefetchIgnore);\n    this.transitions = new Transitions(transitions);\n    this.views = new Views(views);\n\n    // Add prevent custom\n    if (preventCustom !== null) {\n      if (typeof preventCustom !== 'function') {\n        throw new Error('[@barba/core] Prevent should be a function');\n      }\n\n      this.prevent.add('preventCustom', preventCustom);\n    }\n\n    // 5. Use \"current\" data\n    // Init history\n    this.history.init(current.url.href, current.namespace);\n    // Add to cache\n    // TODO: do not cache renderer HTML, only request results…\n    // this.cache.set(current.url.href, Promise.resolve(current.html), 'init');\n\n    // 6. Bind context\n    this._onLinkEnter = this._onLinkEnter.bind(this);\n    this._onLinkClick = this._onLinkClick.bind(this);\n    this._onStateChange = this._onStateChange.bind(this);\n    this._bind();\n\n    // 7. Init plugins\n    this.plugins.forEach(plugin => plugin.init());\n\n    // 8. Barba ready\n    // Set next + trigger for once and `beforeEnter`/`afterEnter` view on page load.\n    const onceData = this.data;\n\n    onceData.trigger = 'barba';\n    onceData.next = onceData.current;\n    onceData.current = { ...this.schemaPage };\n    this.hooks.do('ready', onceData);\n\n    // 9. Finally, do once…\n    this.once(onceData);\n\n    // Clean data for first barba transition…\n    this._resetData();\n  }\n\n  public destroy(): void {\n    this._resetData();\n    this._unbind();\n    this.history.clear();\n    this.hooks.clear();\n    this.plugins = [];\n  }\n\n  get data(): ITransitionData {\n    return this._data;\n  }\n\n  get wrapper(): HTMLElement {\n    return this._wrapper;\n  }\n\n  /**\n   * ### Force a page change without Barba transition.\n   */\n  public force(href: string): void {\n    // DEV\n    // Can be used waiting animation cancellation management…\n    window.location.assign(href);\n  }\n\n  /**\n   * ### Go for a Barba transition.\n   *\n   * Manage \"self page\" href:\n   *\n   * - if same url and no self transition, keep default behavior\n   *   - link: reload the page\n   *   - anchor: scroll to\n   * - if same url with self transition, use it\n   * - then start a page transition.\n   */\n  public go(\n    href: string,\n    trigger: Trigger = 'barba',\n    e?: LinkEvent | PopStateEvent\n  ): Promise<void> {\n    // If animation running, force reload\n    if (this.transitions.isRunning) {\n      this.force(href);\n\n      return;\n    }\n\n    let self = false;\n\n    // Check prevent sameURL against current history\n    // + state check\n    // + update trigger with direction\n    if (trigger === 'popstate') {\n      self =\n        this.history.current &&\n        this.url.getPath(this.history.current.url) === this.url.getPath(href);\n    } else {\n      self = this.prevent.run('sameUrl', null, null, href);\n    }\n\n    if (self && !this.transitions.hasSelf) {\n      return;\n    }\n\n    trigger = this.history.change(href, trigger, e);\n\n    if (e) {\n      e.stopPropagation();\n      e.preventDefault();\n    }\n\n    return this.page(href, trigger, self);\n  }\n\n  /**\n   * ### Start an \"once\" transition.\n   *\n   * If some registered \"once\" transition,\n   * get the \"resolved\" transition from the store and start it.\n   */\n  public async once(readyData: ITransitionData): Promise<void> {\n    await this.hooks.do('beforeEnter', readyData);\n\n    // Check if once transition\n    if (this.transitions.hasOnce) {\n      const transition = this.transitions.get(readyData, {\n        once: true,\n      }) as ITransitionOnce;\n\n      await this.transitions.doOnce({ transition, data: readyData });\n    }\n\n    await this.hooks.do('afterEnter', readyData);\n  }\n\n  /**\n   * ### Start a \"page\" transition.\n   *\n   * 1. If no running transition, updates data with full URL properties and trigger.\n   * 2. Get page from cache or init request.\n   * 3. Wait if some transitions need \"next\" data (`sync: true`, `to: …`).\n   * 4. Manage the history, depending on trigger.\n   * 5. Get \"data\" and trigger \"go\" hook.\n   * 6. Get the \"resolved\" transition from the store and start it.\n   * 7. Update title and reset data (current, next = undefined).\n   *\n   * > If \"self\", use the \"self\" transition\n   */\n  public async page(\n    href: string,\n    trigger: Trigger,\n    self: boolean\n  ): Promise<void> {\n    this.data.next.url = {\n      href,\n      ...this.url.parse(href),\n    };\n    this.data.trigger = trigger;\n\n    const page = this.cache.has(href)\n      ? this.cache.update(href, { action: 'click' }).request\n      : this.cache.set(\n          href,\n          this.request(\n            href,\n            this.timeout,\n            this.onRequestError.bind(this, trigger)\n          ),\n          'click'\n        ).request;\n\n    // Need to wait before getting the right transition\n    if (this.transitions.shouldWait) {\n      await helpers.update(page, this.data);\n    }\n\n    const data = this.data;\n\n    // Hook: between trigger and transition\n    // Can be used to resolve \"route\"…\n    await this.hooks.do('page', data);\n\n    try {\n      const transition = this.transitions.get(data, {\n        once: false,\n        self,\n      }) as ITransitionPage;\n\n      await this.transitions.doPage({\n        data,\n        page,\n        transition,\n        wrapper: this._wrapper,\n      });\n\n      this._resetData();\n    } catch (error) {\n      // Something went wrong (rejected promise, error, 404, 505, other…)\n      // TODO: manage / use cases for cancellation\n      // this.logger.debug('Transition cancelled');\n\n      // If transition error and no debug mode, force reload page.\n      /* istanbul ignore else */\n      if (Logger.getLevel() === 0) {\n        this.force(data.current.url.href);\n      }\n    }\n  }\n\n  /**\n   * When a request error occurs.\n   *\n   * Allow the user to manage request error. (E.g: 404)\n   */\n  public onRequestError(trigger: Trigger, ...args: any): boolean {\n    // Cancel transition status\n    this.transitions.isRunning = false;\n\n    const [href, response]: [string, RequestErrorOrResponse] = args;\n    const action = this.cache.getAction(href);\n    this.cache.delete(href);\n\n    // Custom requestError returning false will return here.\n    if (\n      this._requestCustomError &&\n      this._requestCustomError(trigger, action, href, response) === false\n    ) {\n      return false;\n    }\n\n    // Force page change\n    if (action === 'click') {\n      this.force(href);\n    }\n    return false;\n  }\n\n  /**\n   * Programmatically prefetch\n   */\n  public prefetch(href: string) {\n    // Already in cache\n    /* istanbul ignore next */\n    if (this.cache.has(href)) {\n      return;\n    }\n\n    this.cache.set(\n      href,\n      this.request(\n        href,\n        this.timeout,\n        this.onRequestError.bind(this, 'barba')\n      ).catch((error: RequestErrorOrResponse) => {\n        this.logger.error(error);\n      }),\n      'prefetch'\n    );\n  }\n\n  /**\n   * Bind event listeners.\n   */\n  private _bind(): void {\n    /* istanbul ignore else */\n    if (this.prefetchIgnore !== true) {\n      document.addEventListener('mouseover', this._onLinkEnter);\n      document.addEventListener('touchstart', this._onLinkEnter);\n    }\n    document.addEventListener('click', this._onLinkClick);\n    window.addEventListener('popstate', this._onStateChange);\n  }\n\n  /**\n   * Bind event listeners.\n   */\n  private _unbind(): void {\n    /* istanbul ignore else */\n    if (this.prefetchIgnore !== true) {\n      document.removeEventListener('mouseover', this._onLinkEnter);\n      document.removeEventListener('touchstart', this._onLinkEnter);\n    }\n    document.removeEventListener('click', this._onLinkClick);\n    window.removeEventListener('popstate', this._onStateChange);\n  }\n\n  /**\n   * When a element is entered.\n   *\n   * Get valid link element.\n   * Cache URL if needed.\n   */\n  private _onLinkEnter(e: LinkEvent): void {\n    const link = this._getLinkElement(e);\n\n    if (!link) {\n      return;\n    }\n\n    const href = this.dom.getHref(link);\n\n    if (this.prevent.checkHref(href)) {\n      return;\n    }\n\n    // Already in cache\n    if (this.cache.has(href)) {\n      return;\n    }\n\n    this.cache.set(\n      href,\n      this.request(\n        href,\n        this.timeout,\n        this.onRequestError.bind(this, link)\n      ).catch((error: RequestErrorOrResponse) => {\n        this.logger.error(error);\n      }),\n      'enter'\n    );\n  }\n\n  /**\n   * When an element is clicked.\n   *\n   * Get valid link element.\n   * Prevent same URL.\n   * Go for a Barba transition.\n   */\n  private _onLinkClick(e: LinkEvent): void {\n    // This use `prevent.checkLink` under the hood to get eligible link.\n    const link = this._getLinkElement(e);\n\n    if (!link) {\n      return;\n    }\n\n    if (this.transitions.isRunning && this.preventRunning) {\n      e.preventDefault();\n      e.stopPropagation();\n\n      return;\n    }\n\n    this.go(this.dom.getHref(link), link, e);\n  }\n\n  /**\n   * When History state changes.\n   *\n   * Get \"href\" from URL\n   * Go for a Barba transition.\n   */\n  private _onStateChange(e: PopStateEvent): void {\n    this.go(this.url.getHref(), 'popstate', e);\n  }\n\n  /**\n   * Get a valid link ancestor.\n   *\n   * Check for a \"href\" attribute.\n   * Then check if eligible for Barba.\n   */\n  private _getLinkElement(e: LinkEvent): Link {\n    let el = e.target as Link;\n\n    while (el && !this.dom.getHref(el)) {\n      el = (el as HTMLElement).parentNode as Link;\n    }\n\n    // Check prevent\n    if (!el || this.prevent.checkLink(el, e, this.dom.getHref(el))) {\n      return;\n    }\n\n    return el;\n  }\n\n  /**\n   * Reset pages data.\n   *\n   * Set \"current\" and unset \"next\".\n   */\n  private _resetData() {\n    const href = this.url.getHref();\n    const current = {\n      container: this.dom.getContainer(),\n      html: this.dom.getHtml(),\n      namespace: this.dom.getNamespace(),\n      url: {\n        href,\n        ...this.url.parse(href),\n      },\n    };\n\n    this._data = {\n      current,\n      next: { ...this.schemaPage },\n      trigger: undefined,\n    };\n\n    this.hooks.do('reset', this.data);\n  }\n}\n\nconst core = new Core();\n\nexport default core;\n"]},"metadata":{},"sourceType":"script"}